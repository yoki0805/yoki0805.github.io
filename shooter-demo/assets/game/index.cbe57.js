System.register("chunks:///game.js",["./rollupPluginModLoBabelHelpers-a0dd97cd.js","cc"],(function(){"use strict";var t,e,n,i,o,r,s,a,l,u,c,h,p,d,f,g,m,y,v,b,P,w,S,M,T,B,C,x,_,R,F,N,A,D,I,E,z,L,k,O,W,U,H,G,V,X,Z,q,j,Y,K,J,Q,$,tt,et,nt,it,ot,rt,st,at,lt,ut,ct,ht,pt,dt,ft,gt,mt,yt;return{setters:[function(s){t=s.a,e=s.b,n=s.c,i=s.d,o=s.e,r=s.f},function(t){s=t.cclegacy,a=t.sys,l=t.v4,u=t._decorator,c=t.MeshRenderer,h=t.UIMeshRenderer,p=t.error,d=t.gfx,f=t.clamp,g=t.Component,m=t.geometry,y=t.mat4,v=t.v3,b=t.v2,P=t.UITransform,w=t.PhysicsSystem,S=t.Animation,M=t.math,T=t.tween,B=t.lerp,C=t.UIOpacity,x=t.Node,_=t.find,R=t.Prefab,F=t.quat,N=t.instantiate,A=t.Tween,D=t.CCInteger,I=t.BoxCollider,E=t.Quat,z=t.physics,L=t.Vec3,k=t.AnimationClip,O=t.director,W=t.NodePool,U=t.Label,H=t.game,G=t.input,V=t.Input,X=t.KeyCode,Z=t.Layers,q=t.Camera,j=t.Game,Y=t.AudioSource,K=t.assetManager,J=t.AudioClip,Q=t.Button,$=t.ParticleSystem2D,tt=t.Vec2,et=t.view,nt=t.rect,it=t.SpriteFrame,ot=t.Texture2D,rt=t.size,st=t.CacheMode,at=t.Director,lt=t.Sprite,ut=t.UIRenderer,ct=t.Color,ht=t.screen,pt=t.macro,dt=t.renderer,ft=t.equals,gt=t.BatchingUtility,mt=t.warn,yt=t.clamp01}],execute:function(){s._RF.push({},"90dc3pdbUNLk4sJgq6D4PYA","Configurations",void 0);var vt,bt,Pt,wt,St,Mt,Tt,Bt,Ct,xt,_t,Rt,Ft,Nt,At,Dt={scale:1,maxLongSideRate:21/9,maxShortSideRate:9/16},It={isDevTest:!1};!function(){if(!1!==a.isBrowser){var t=window.location.href,e=t.includes("web-mobile"),n=t.includes("github.io");It.isDevTest=e||n}else It.isDevTest=!1}(),s._RF.pop(),s._RF.push({},"78a67/+LbZNJ6UO9Dj7LNsD","MeshCustomColor",void 0);var Et=l(),zt=u.ccclass,Lt=u.property,kt=(vt=zt("MeshCustomColor"),bt=Lt({type:[c],tooltip:"放置所需的 MeshRenderer\n(材質需要打開混合模式)"}),Pt=Lt({tooltip:"不透明程度: 0 - 255"}),wt=Lt({tooltip:"漂色程度: 0 - 1"}),St=Lt({tooltip:"灰色程度: 0 - 1"}),Mt=Lt({tooltip:"材質是否勾選 USE INSTANCING (需一致)"}),Tt=Lt({tooltip:"是否運行遊戲後自動設定"}),vt((xt=t((Ct=function(t){function s(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"meshRenderers",xt,i(e)),n(e,"_opacity",_t,i(e)),n(e,"_bleach",Rt,i(e)),n(e,"_grayScale",Ft,i(e)),n(e,"useInstancing",Nt,i(e)),n(e,"playOnLoad",At,i(e)),e.a_custom_color_ctrl=[0,0,0,1],e}e(s,t);var a=s.prototype;return a.onLoad=function(){var t=this;It.isDevTest&&this.useInstancing&&(this.meshRenderers.some((function(t){return!!t.node.getComponent(h)}))&&p("GPU instancing is not supported in 'UI Render Pipeline'."));this.playOnLoad&&this.scheduleOnce((function(){t.opacity=t._opacity,t.bleach=t._bleach}))},a.setOpacity=function(t,e){var n=t.getHandle("mainColor",0,d.Type.FLOAT4);if(0!==n){var i=t.getUniform(n,Et);i.w=e/255,t.setUniform(n,i)}},a.setBleach=function(t,e){var n=t.getHandle("bleachColor",0,d.Type.FLOAT4);if(0!==n){var i=t.getUniform(n,Et);i.w=e,t.setUniform(n,i)}},a.setGrayScale=function(t,e){var n=t.getHandle("grayScale",0,d.Type.FLOAT);0!==n&&t.setUniform(n,e)},o(s,[{key:"opacity",get:function(){return this._opacity},set:function(t){var e=this.meshRenderers,n=f(Math.floor(t),0,255);if(this._opacity=n,!0===this.useInstancing){this.a_custom_color_ctrl[0]=(255-n)/255;for(var i,o=r(e);!(i=o()).done;){i.value.setInstancedAttribute("a_custom_color_ctrl",this.a_custom_color_ctrl)}}else for(var s,a=r(e);!(s=a()).done;)for(var l,u=s.value.materials,c=r(u);!(l=c()).done;)for(var h,p=l.value,d=r(p.passes);!(h=d()).done;){var g=h.value;this.setOpacity(g,n)}}},{key:"bleach",get:function(){return this._bleach},set:function(t){var e=this.meshRenderers,n=f(t,0,1);if(this._bleach=n,!0===this.useInstancing){this.a_custom_color_ctrl[1]=n;for(var i,o=r(e);!(i=o()).done;){i.value.setInstancedAttribute("a_custom_color_ctrl",this.a_custom_color_ctrl)}}else for(var s,a=r(e);!(s=a()).done;)for(var l,u=s.value.materials,c=r(u);!(l=c()).done;){var h=l.value;this.setBleach(h.passes[0],this._bleach)}}},{key:"grayScale",get:function(){return this._grayScale},set:function(t){var e=this.meshRenderers,n=f(t,0,1);if(this._grayScale=n,!0===this.useInstancing){this.a_custom_color_ctrl[2]=n;for(var i,o=r(e);!(i=o()).done;){i.value.setInstancedAttribute("a_custom_color_ctrl",this.a_custom_color_ctrl)}}else for(var s,a=r(e);!(s=a()).done;)for(var l,u=s.value.materials,c=r(u);!(l=c()).done;){var h=l.value;this.setGrayScale(h.passes[0],this._grayScale)}}}]),s}(g)).prototype,"meshRenderers",[bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),t(Ct.prototype,"opacity",[Pt],Object.getOwnPropertyDescriptor(Ct.prototype,"opacity"),Ct.prototype),_t=t(Ct.prototype,"_opacity",[Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),t(Ct.prototype,"bleach",[wt],Object.getOwnPropertyDescriptor(Ct.prototype,"bleach"),Ct.prototype),Rt=t(Ct.prototype,"_bleach",[Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),t(Ct.prototype,"grayScale",[St],Object.getOwnPropertyDescriptor(Ct.prototype,"grayScale"),Ct.prototype),Ft=t(Ct.prototype,"_grayScale",[Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Nt=t(Ct.prototype,"useInstancing",[Mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),At=t(Ct.prototype,"playOnLoad",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Bt=Ct))||Bt);s._RF.pop(),s._RF.push({},"37a1bxEw0ZEO6+2ZgrHAXjW","Coordinate",void 0);var Ot=new m.Ray,Wt=(y(),v()),Ut=b();function Ht(t,e){var n;return e=null!=(n=e)?n:v(),t.getLocation(Ut),e.set(Ut.x,Ut.y,0)}function Gt(t,e){var n;return e=null!=(n=e)?n:v(),t.getUILocation(Ut),e.set(Ut.x,Ut.y,0)}function Vt(t,e,n,i){var o;i=null!=(o=i)?o:v();var r=t.worldToScreen(n,Wt);return e.screenToWorld(r,i)}function Xt(t,e,n,i){return void 0===e&&(e=""),void 0===n&&(n=null),void 0===i&&(i=null),function(t,e,n,i,o){void 0===n&&(n="");void 0===i&&(i=null);void 0===o&&(o=null);var r=e.play?e:e.getComponent(S),s=null;if(r){""!==n&&null!==n||(n=r.defaultClip?r.defaultClip.name:r.clips[0]?r.clips[0].name:"");var a=S.EventType;switch(r.off(a.FINISHED),t){case 1:r.play(n);break;case 2:r.crossFade(n)}if(null===(s=r.getState(n)))return s;null!==i&&(s.wrapMode=i),o&&r.once(a.FINISHED,(function(){return o()}))}return s}(1,t,e,n,i)}s._RF.pop(),s._RF.push({},"27230InEctLXo9Xsdd2J0R1","AnimationHelper",void 0),s._RF.pop(),s._RF.push({},"a6f03YiUO1CQ6uUzJSusRCA","Utils",void 0);var Zt={};function qt(t,e){if(t>e){var n=[e,t];t=n[0],e=n[1]}return M.randomRangeInt(t,e+1)}function jt(t){return t[M.randomRangeInt(0,t.length)]}function Yt(t){return t[t.length-1]}function Kt(t,e,n){if(t<=e)for(;t<=e;)n(t),++t;else for(;t>=e;)n(t),--t}function Jt(t){if(Math.abs(t%1)<.01){var e=t.toFixed(0);return t>=1e3?e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):e}var n=t.toFixed(2),i=n.indexOf("."),o=n.slice(0,i),r=n.slice(i);return""+o.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+r}function Qt(t){return function(e){return Math.pow(e,t)}}function $t(t,e,n,i,o){var r=re(t,n);n<0&&(n=r.opacity);var s=o?function(t){return B(n,i,o(t))}:function(t){return B(n,i,t)};return T(t).by(e,Zt,{onUpdate:function(t,e){return r.opacity=s(e)}})}function te(t,e){var n=T(t);return n.by(31536e4,Zt,{onUpdate:function(t,i){return e(n)}}).repeatForever().start()}function ee(t,e,n,i){var o=T(t);return o.call((function(){return i(o)})).delay(Math.max(1e-7,e)).union().repeat(Math.max(0,n)).start()}function ne(t,e,n){var i=T(t);return i.call((function(){return n(i)})).delay(Math.max(1e-7,e)).union().repeatForever().start()}function ie(t,e,n){var i=T(t);return e>0&&i.delay(e),i.call(n).start()}function oe(t,e,n){var i=t.getComponent(P),o=e<0?i.width:e,r=n<0?i.height:n;return(e>=0||n>=0)&&i.setContentSize(o,r),i}function re(t,e){var n=t.getComponent(C);return e>=0&&(n.opacity=e),n}function se(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=e.length;switch(i){case 1:return _(e[0]);case 2:if("string"==typeof e[0])return e[1]instanceof x?_(e[0],e[1]):e[1].node instanceof x?_(e[0],e[1].node):_(e[0]).getComponent(e[1]);var o=e[0]instanceof x?e[0]:e[0].node;return"string"==typeof e[1]?_(e[1],o):o.getComponent(e[1]);case 3:var r=e[0]instanceof x?e[0]:e[0].node,s=_(e[1],r);if(s)return s.getComponent(e[2])}return null}s._RF.pop(),s._RF.push({},"097cfRh8ApDYIK+ymeakAfN","ShootMode",void 0);var ae=1,le=2,ue=3;s._RF.pop(),s._RF.push({},"e05f1SqoW9MF57t/gqhf9oN","ShootBetRate",void 0);var ce=1,he=5;s._RF.pop(),s._RF.push({},"4ab23VolpRBAYNG2wIEWN2n","BulletData",void 0),s._RF.pop(),s._RF.push({},"e2a62SR6d5HmLnQy3/smEM0","GameHelper",void 0);var pe,de={props:{empty:{},opacity_0:{opacity:0},opacity_255:{opacity:255},position_0_n100_0:{position:v(0,-100,0)},angle_0_0_n720:{eulerAngles:v(0,0,-720)},angle_0_0_360:{eulerAngles:v(0,0,360)}},opts:{easeOut_2:{easing:(pe=2,function(t){return 1-Math.pow(1-t,pe)})},easeIn_2:{easing:Qt(2)}}},fe={props:{positions:[{position:v(0,8,0)},{position:v(0,0,0)},{position:v(0,-8,0)},{position:v(0,0,0)}],angles:[{eulerAngles:v(0,0,2)},{eulerAngles:v(0,0,4)},{eulerAngles:v(0,0,-4)},{eulerAngles:v(0,0,2)}]}};s._RF.pop(),s._RF.push({},"960921PZNZEzbq+iNjH2haU","Game",void 0);var ge,me,ye,ve,be,Pe,we,Se,Me,Te,Be,Ce={cam2D:null,cam3D:null,dataMgr:null,gameCtrl:null,monsterMgr:null,shootingMgr:null,effectMgr:null,sndMgr:null,uiCtrl:null,node:{stage:null,display:null,scene:null,ui:null,riverLayer:null,waterLayer:null,landLayer:null,cannonLayer:null,bulletLayer:null,enemyLayer:null,effect3DLayer:null,touchPanel:null,effect2DLayer:null,playerLayer:null,buttonLayer:null,rewardLayer:null,noticeLayer:null,uiLayer:null},_env:new Map,setValue:function(t,e){this._env.set(t,e)},getValue:function(t){var e=this._env.get(t);return void 0===e?null:e}};s._RF.pop(),s._RF.push({},"5f5e4xMk1JGqZfKsiLzgu6G","AxeBullet",void 0);var xe=900,_e=10,Re=v(),Fe=v(),Ne=u.ccclass,Ae=u.property,De=(ge=Ne("AxeBullet"),me=Ae({type:x,tooltip:"飛斧的移動節點"}),ye=Ae({type:x,tooltip:"飛斧的旋轉節點"}),ve=Ae({type:x,tooltip:"飛斧的光效節點"}),be=Ae({type:R,tooltip:"受擊效果"}),ge((Se=t((we=function(t){function r(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"moveNode",Se,i(e)),n(e,"rotNode",Me,i(e)),n(e,"lightNode",Te,i(e)),n(e,"hitFxPrefab",Be,i(e)),e.bltData={type:0,id:0,bet:0,cost:0,using:!1},e.hitFxNode=null,e.reuseFunc=null,e.axeHandSide=0,e.axeInitRot=F(),e.lifetime=0,e.speed=0,e.isHit=!1,e.isCosted=!1,e.isFlying=!1,e.hitTarget=null,e.aimTarget=null,e.aimBulletPos=v(),e.targetStartPos=v(),e.targetOffset=v(),e.bltStartPos=v(),e.hitWpos2D=v(),e}e(r,t);var s=r.prototype;return s.onLoad=function(){this.rotNode.getRotation(this.axeInitRot)},s.onDestroy=function(){var t;null==(t=this.hitFxNode)||t.destroy(),this.hitFxNode=null,this.reuseFunc=null,this.clearBulletAction()},s.update=function(t){this.isUsing()&&(this.lifetime-=t,this.lifetime<=0?this.onMiss():this.updatePosition(t))},s.init=function(t,e,n,i,o,r,s){void 0===s&&(s=null);var a=this.bltData;a.type=ue,a.id=e,a.bet=n,a.cost=i,a.using=!0,this.node.setWorldPosition(t),this.reuseFunc=s,this.isFlying=!1,this.isCosted=!1,this.isHit=!1;var l=Ce.monsterMgr.getEntityByID(o);return l&&l.isUsing()?(this.axeHandSide=r,this.aimTarget=l,this.setup(),this.isFlying=!0,this.isCosted=!0,!0):(this.destroyBullet(),!1)},s.setup=function(){this.speed=xe,this.lifetime=_e,this.bltStartPos.set(this.node.position),this.targetStartPos.set(this.aimTarget.node.position),this.targetOffset.set(0,0,0),this.moveNode.setPosition(0,0,0),this.lightNode.active=!0,this.setAiming(),this.setTrackFx()},s.setAiming=function(){var t=this,e=this.node,n=this.axeHandSide,i=0===n?-30:30,o=M.randomRange(25,35)*(0===n?1:-1);e.setRotationFromEuler(0,0,o);var r=this.moveNode,s=r.position,a=Ce.shootingMgr.getAimingWorldPos(this.aimTarget,Fe),l=r.parent.inverseTransformPoint(Re,a),u=Fe.set(l).subtract(s);u.x+=i,u.y=0;var c=u.length(),h=Math.max(.5,c/this.speed),p=h/2,d=Math.min(350,Math.max(c/4,l.y+25)),f=s.y+d,g=l.y,m=r.getPosition(this.aimBulletPos);T(m).to(p,{y:f},de.opts.easeOut_2).to(p,{y:g},de.opts.easeIn_2).start(),T(m).by(h,{x:u.x,z:u.z}).call((function(){var e=t.aimTarget;e&&e.isUsing()?(t.hitTarget=e,t.onHit()):t.onMiss()})).start(),this.rotNode.setRotation(this.axeInitRot),T(this.rotNode).by(h,de.props.angle_0_0_n720).repeatForever().start()},s.setTrackFx=function(){var t=this;T(this.rotNode).delay(.1).call((function(){var e=Ce.dataMgr.getAxeBulletTrackFxNode();e.setParent(Ce.node.effect3DLayer),e.setWorldPosition(t.moveNode.worldPosition),e.setRotation(t.node.worldRotation),Xt(e,"",null,(function(){Ce.dataMgr.putToAxeBulletTrackFxPool(e)}))})).union().repeatForever().start()},s.onHit=function(){var t=this;this.isHit=!0,this.updateHitWpos2D(),this.makeFakeAxeOnHit();var e=Math.floor(he);this.hitTarget.showHurt(e),Ce.monsterMgr.entityOnHit(this.hitTarget,this.bltData),this.playHitFx((function(){return t.destroyBullet()})),this.node.setPosition(0,-1e6,0),this.clearBulletAction()},s.onMiss=function(){var t=this;if(this.isHit=!1,this.updateHitWpos2D(),this.isCosted){var e=this.bltData;Ce.effectMgr.showMissText(this.hitWpos2D),Ce.shootingMgr.cancelShoot(e.type,e.id,e.bet,e.cost),this.isCosted=!1}this.playHitFx((function(){return t.destroyBullet()})),this.node.setPosition(0,-1e6,0),this.clearBulletAction()},s.updateHitWpos2D=function(){Vt(Ce.cam3D,Ce.cam2D,this.moveNode.worldPosition,this.hitWpos2D)},s.playHitFx=function(t){var e,n=this,i=null!=(e=this.hitFxNode)?e:N(this.hitFxPrefab);i.setParent(Ce.node.effect2DLayer),this.hitFxNode=i,i.setWorldPosition(this.hitWpos2D),i.angle=this.node.eulerAngles.z,Xt(i,"",null,(function(){n.hitFxNode.removeFromParent(),t()}))},s.makeFakeAxeOnHit=function(){var t=this.hitTarget;if(t&&t.isUsing()){var e=this.node,n=this.rotNode,i=Ce.dataMgr.getAxeModelNode(),o=i.getComponent(kt);i.setParent(t.node),i.setWorldPosition(n.worldPosition),i.setWorldRotation(e.worldRotation),ie(i,.55,(function(){T(o).to(.25,de.props.opacity_0,de.opts.easeIn_2).call((function(){o.opacity=255,A.stopAllByTarget(o),Ce.dataMgr.putToAxeModelPool(i)})).start()}))}},s.clearBulletAction=function(){this.isFlying&&(A.stopAllByTarget(this.rotNode),A.stopAllByTarget(this.aimBulletPos),this.moveNode.setPosition(0,0,0),this.aimTarget=null,this.hitTarget=null,this.isFlying=!1,this.lifetime=0,this.setUsing(!1))},s.destroyBullet=function(){this.clearBulletAction(),this.reuseFunc?(this.reuseFunc(),this.reuseFunc=null):this.node.destroy()},s.updatePosition=function(t){var e=this.aimTarget;if(e&&e.isUsing()){var n=e.node.position;this.targetOffset.set(n).subtract(this.targetStartPos),this.targetOffset.add3f(0,30,70)}var i=Fe.set(this.bltStartPos).add(this.targetOffset);this.moveNode.setPosition(this.aimBulletPos),this.node.setPosition(i)},s.setUsing=function(t){this.bltData.using=t},s.isUsing=function(){return this.bltData.using},o(r,[{key:"data",get:function(){return this.bltData}}]),r}(g)).prototype,"moveNode",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=t(we.prototype,"rotNode",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=t(we.prototype,"lightNode",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=t(we.prototype,"hitFxPrefab",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=we))||Pe);function Ie(t,e){return t.delay(e)}function Ee(t,e){return t.set({position:v(e)})}function ze(t,e,n){return t.to(e,{position:v(n)})}s._RF.pop(),s._RF.push({},"dc3f5r07t9HarOzCXBrn5If","PathData",void 0);var Le=new Map;var ke=T();Ie(ke,0),Ee(ke,v(810,0,-280)),ze(ke,20,v(-810,0,-280)),Le.set(1,ke);var Oe=T();Ie(Oe,0),Ee(Oe,v(-810,0,150)),ze(Oe,20,v(810,0,150)),Le.set(2,Oe);var We=T();Ie(We,0),Ee(We,v(-810,0,-320)),ze(We,6,v(-300,0,-320)),ze(We,5,v(-300,0,280)),ze(We,6,v(-810,0,280)),Le.set(3,We);var Ue=T();Ie(Ue,0),Ee(Ue,v(810,0,-320)),ze(Ue,6,v(300,0,-320)),ze(Ue,5,v(300,0,280)),ze(Ue,6,v(810,0,280)),Le.set(4,Ue);var He=T();Ie(He,0),Ee(He,v(-810,0,160)),ze(He,4,v(-480,0,160)),ze(He,3,v(-480,0,-180)),ze(He,4,v(-810,0,-180)),Le.set(5,He);var Ge=T();Ie(Ge,0),Ee(Ge,v(810,0,160)),ze(Ge,4,v(480,0,160)),ze(Ge,3,v(480,0,-180)),ze(Ge,4,v(810,0,-180)),Le.set(6,Ge);var Ve,Xe,Ze,qe,je,Ye,Ke,Je,Qe,$e,tn,en,nn,on,rn,sn,an,ln=T();Ie(ln,0),Ee(ln,v(0,0,-120)),ze(ln,65,v(0,0,-120)),Le.set(101,ln),s._RF.pop(),s._RF.push({},"813f2p4eGZMepzko/SGpeYR","Monster",void 0);var un,cn,hn,pn,dn,fn,gn,mn=u.ccclass,yn=u.property,vn=(Ve=mn("Monster"),Xe=yn([D]),Ze=yn([S]),qe=yn([x]),je=yn([I]),Ye=yn({tooltip:"是否為一般怪物"}),Ke=yn({tooltip:"是否為特殊怪物"}),Je=yn({tooltip:"是否為 Boss 怪物"}),Ve((tn=t(($e=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"oddsList",tn,i(e)),n(e,"monsterAnims",en,i(e)),n(e,"aimNodes",nn,i(e)),n(e,"colliders",on,i(e)),n(e,"isNormalMonster",rn,i(e)),n(e,"isSpecialMonster",sn,i(e)),n(e,"isBossMonster",an,i(e)),e.meshCustomColor=null,e.damagetween=null,e.tintBase=0,e.no=0,e.id=0,e.oddsIndex=0,e.using=!1,e.defaultScale=v(1,1,1),e.moveTween=null,e.moveEnd=!1,e.reuse=!0,e}e(o,t);var r=o.prototype;return r.onLoad=function(){this.meshCustomColor=this.getComponent(kt),this.defaultScale.set(this.node.scale)},r.onDestroy=function(){A.stopAllByTarget(this.node),this.stopDamageTint(),this.stopMove()},r.init=function(t,e){this.no=t,this.id=e,this.colliders.forEach((function(t){t.enabled=!0})),this.using=!0,this.reuse=!0,this.moveEnd=!1;var n=this.node;n.setScale(this.defaultScale),n.setRotation(E.IDENTITY),n.setPosition(0,-5e3,0)},r.setMovePath=function(t){var e=this;this.moveTween&&this.stopMove();var n=function(t,e){var n=Le.get(t);return n?n.clone(e):null}(t,this.node);return n?(this.moveEnd=!1,this.moveTween=n.call((function(){e.scheduleOnce((function(){return e.pushToPool()})),e.moveTween=null,e.moveEnd=!0})).start(),!0):(this.moveEnd=!0,!1)},r.stopMove=function(){var t;null==(t=this.moveTween)||t.stop(),this.moveTween=null,this.moveEnd=!0},r.pushToPool=function(){A.stopAllByTarget(this.node),this.damageTint(!1),this.setGrayScale(0),this.stopMove(),this.using=!1,this.node.setScale(this.defaultScale),Ce.monsterMgr.removeFromEntitiesMap(this.id),this.reuse?Ce.dataMgr.putToMonsterPool(this.node,this.no):this.node.destroy()},r.setGrayScale=function(t){var e=this.meshCustomColor;e&&(e.grayScale=t)},r.damageTint=function(t,e){var n=this;void 0===e&&(e=.25);var i=this.meshCustomColor;if(i)if(t){if(t&&!this.damagetween){i.bleach=this.tintBase,this.damagetween=T(i).to(e,{bleach:.67},de.opts.easeOut_2).call((function(){i.bleach=n.tintBase,n.damagetween=null})).start()}}else i.bleach=this.tintBase,this.stopDamageTint()},r.stopDamageTint=function(){var t;null==(t=this.damagetween)||t.stop(),this.damagetween=null},r.getDefaultScale=function(){return this.defaultScale},r.getOdds=function(){return this.oddsList[this.oddsIndex]},r.getNo=function(){return this.no},r.getID=function(){return this.id},r.isMoveEnd=function(){return this.moveEnd},r.setUsing=function(t){this.using=t},r.isUsing=function(){return this.using},r.setReuse=function(t){this.reuse=t},r.isReuse=function(){return this.reuse},r.postInit=function(){},r.showHurt=function(t){},r.showReward=function(t){return!1},r.showDeath=function(){},r.getHurtSndName=function(){return""},o}(g)).prototype,"oddsList",[Xe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),en=t($e.prototype,"monsterAnims",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nn=t($e.prototype,"aimNodes",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),on=t($e.prototype,"colliders",[je],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rn=t($e.prototype,"isNormalMonster",[Ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),sn=t($e.prototype,"isSpecialMonster",[Ke],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),an=t($e.prototype,"isBossMonster",[Je],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qe=$e))||Qe);s._RF.pop(),s._RF.push({},"92466bMH11EPrIe1fnWyAUU","NormalBullet",void 0);var bn,Pn,wn,Sn,Mn,Tn,Bn,Cn,xn,_n,Rn,Fn=1100,Nn=800,An=10,Dn=v(),In=v(),En=F(),zn=u.ccclass,Ln=u.property,kn=(un=zn("NormalBullet"),cn=Ln({type:x,tooltip:"子彈的旋轉節點"}),hn=Ln({type:R,tooltip:"受擊效果"}),un((fn=t((dn=function(t){function r(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"rotNode",fn,i(e)),n(e,"hitFxPrefab",gn,i(e)),e.bltData={type:0,id:0,bet:0,cost:0,using:!1},e.collider=null,e.hitFxNode=null,e.reuseFunc=null,e.lifetime=0,e.speed=0,e.dir=v(),e.vel=v(),e.isHit=!1,e.isAiming=!1,e.isCosted=!1,e.isFlying=!1,e.hitTarget=null,e.aimTarget=null,e.aimBulletPos=v(),e.targetStartPos=v(),e.targetOffset=v(),e.hitWpos2D=v(),e}e(r,t);var s=r.prototype;return s.onLoad=function(){this.collider=this.getComponent(I),this.collider.on("onTriggerEnter",this.onTriggerEnter,this)},s.onDestroy=function(){var t;this.collider.off("onTriggerEnter",this.onTriggerEnter,this),null==(t=this.hitFxNode)||t.destroy(),this.hitFxNode=null,this.reuseFunc=null,this.clearBulletAction()},s.update=function(t){this.isUsing()&&(this.lifetime-=t,this.lifetime<=0?this.onMiss():this.updatePosition(t))},s.init=function(t,e,n,i,o,r){void 0===r&&(r=null);var s=this.bltData;if(s.type=ae,s.id=e,s.bet=n,s.cost=i,s.using=!0,this.node.setWorldPosition(t),this.reuseFunc=r,this.isAiming=!1,this.isFlying=!1,this.isCosted=!1,this.isHit=!1,-1!==o){var a=Ce.monsterMgr.getEntityByID(o);if(!a||!a.isUsing())return this.destroyBullet(),!1;s.type=le,this.aimTarget=a,this.isAiming=!0}return this.setup(),this.isFlying=!0,this.isCosted=!0,!0},s.setup=function(){this.isAiming?(this.speed=Nn,this.lifetime=An,this.targetStartPos.set(this.aimTarget.node.position),this.targetOffset.set(0,0,0),this.setAiming()):(this.speed=Fn,this.lifetime=An,this.dir.set(0,0,-1),this.vel.set(this.dir).multiplyScalar(this.speed)),this.alignDirection(),T(this.rotNode).by(.6,de.props.angle_0_0_360).repeatForever().start()},s.setAiming=function(){var t=this,e=this.node,n=e.position,i=Ce.shootingMgr.getAimingWorldPos(this.aimTarget,In),o=e.parent.inverseTransformPoint(Dn,i),r=In.set(o).subtract(n);r.y=0;var s=r.length(),a=Math.max(.5,s/this.speed)/2,l=Math.min(350,Math.max(s/4,o.y+25)),u=n.y+l,c=o.y,h=e.getPosition(this.aimBulletPos);h.add3f(.001*r.x,.002*l,.001*r.z),this.dir.set(h).subtract(n).normalize(),this.vel.set(this.dir).multiplyScalar(this.speed),T(h).to(a,{y:u},de.opts.easeOut_2).to(a,{y:c},de.opts.easeIn_2).start(),T(h).by(2*a,{x:r.x,z:r.z}).call((function(){var e=t.aimTarget;e&&e.isUsing()?(t.hitTarget=e,t.onHit()):t.onMiss()})).start()},s.onTriggerEnter=function(t){if(!this.isAiming){var e=t.otherCollider,n=z.PhysicsGroup,i=e.node,o=e.getGroup();o===n.MONSTER?this.entityOnHit(i):o===n.WALL&&this.wallOnHit(i)}},s.entityOnHit=function(t){var e=t.getComponent(vn);e&&e.isUsing()?(this.hitTarget=e,this.onHit()):this.onMiss()},s.wallOnHit=function(t){var e=Math.abs,n=this.dir,i=this.vel;switch(t.name){case"Top":n.z=e(n.z),i.z=e(i.z);break;case"Down":n.z=-e(n.z),i.z=-e(i.z);break;case"Left":n.x=e(n.x),i.x=e(i.x);break;case"Right":n.x=-e(n.x),i.x=-e(i.x)}this.alignDirection()},s.onHit=function(){var t=this;this.isHit=!0,this.updateHitWpos2D();var e=Math.floor(ce);this.hitTarget.showHurt(e),Ce.monsterMgr.entityOnHit(this.hitTarget,this.bltData),this.playHitFx((function(){return t.destroyBullet()})),this.node.setPosition(0,-1e6,0),this.clearBulletAction()},s.onMiss=function(){var t=this;if(this.isHit=!1,this.updateHitWpos2D(),this.isCosted){var e=this.bltData;Ce.effectMgr.showMissText(this.hitWpos2D),Ce.shootingMgr.cancelShoot(e.type,e.id,e.bet,e.cost),this.isCosted=!1}this.playHitFx((function(){return t.destroyBullet()})),this.node.setPosition(0,-1e6,0),this.clearBulletAction()},s.updateHitWpos2D=function(){Vt(Ce.cam3D,Ce.cam2D,this.node.worldPosition,this.hitWpos2D)},s.playHitFx=function(t){var e,n=this,i=null!=(e=this.hitFxNode)?e:N(this.hitFxPrefab);i.setParent(Ce.node.effect2DLayer),this.hitFxNode=i,i.setWorldPosition(this.hitWpos2D),i.angle=M.randomRange(0,360),Xt(i,"",null,(function(){n.hitFxNode.removeFromParent(),t()}))},s.clearBulletAction=function(){this.isFlying&&(A.stopAllByTarget(this.rotNode),A.stopAllByTarget(this.aimBulletPos),this.aimTarget=null,this.hitTarget=null,this.isFlying=!1,this.lifetime=0,this.setUsing(!1))},s.destroyBullet=function(){this.clearBulletAction(),this.reuseFunc?(this.reuseFunc(),this.reuseFunc=null):this.node.destroy()},s.updatePosition=function(t){var e=this.node;if(this.isAiming){var n=this.aimTarget;if(n&&n.isUsing()){var i=n.node.position;this.targetOffset.set(i).subtract(this.targetStartPos)}var o=In.set(this.aimBulletPos).add(this.targetOffset);this.dir.set(o).subtract(e.position).normalize(),this.vel.set(this.dir).multiplyScalar(this.speed),e.setPosition(o),this.alignDirection()}else{var r=this.vel,s=e.position;e.setPosition(s.x+r.x*t,s.y,s.z+r.z*t)}},s.alignDirection=function(){var t=E.rotationTo(En,L.FORWARD,this.dir);this.node.setRotation(t)},s.setUsing=function(t){this.bltData.using=t},s.isUsing=function(){return this.bltData.using},o(r,[{key:"data",get:function(){return this.bltData}}]),r}(g)).prototype,"rotNode",[cn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gn=t(dn.prototype,"hitFxPrefab",[hn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pn=dn))||pn);s._RF.pop(),s._RF.push({},"75845Qj1nxMHYpvZ/2u5uyd","ShootRecord",void 0),s._RF.pop(),s._RF.push({},"c6efbo2rYhG8ZzR8riyIheD","RoleCannon",void 0);var On,Wn=u.ccclass,Un=u.property,Hn=(bn=Wn("RoleCannon"),Pn=Un(x),wn=Un([x]),Sn=Un(R),Mn=Un(R),bn((Cn=t((Bn=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"normalCannonPivot",Cn,i(e)),n(e,"axeThrowPivots",xn,i(e)),n(e,"normalCannonPrefab",_n,i(e)),n(e,"changeFxPrefab",Rn,i(e)),e.roleNode=null,e.cannonNode=null,e.cannonTapOnNode=null,e.cannonGunFireNode=null,e.axeHandSide=0,e}e(o,t);var r=o.prototype;return r.onLoad=function(){this.roleNode=se(this.node,"RootNode"),this.cannonNode=N(this.normalCannonPrefab),this.cannonTapOnNode=this.cannonNode.getChildByName("TapOn"),this.cannonGunFireNode=this.cannonNode.getChildByName("GunFire"),this.cannonNode.setParent(this.normalCannonPivot),this.axeHandSide=qt(0,1)},r.equip=function(){this.playIdle(),this.playChangeFx()},r.tryToShoot=function(t,e,n){var i=Ce.dataMgr,o=Ce.shootingMgr,r=null!=n?n:{bltID:0,bltBet:0,bltCost:0,aimingID:0,shootMode:0,isShot:!1},s=o.shootMode;switch(r.bltID=0,r.bltBet=t,r.bltCost=e,r.aimingID=o.getAimingID(),r.shootMode=s,r.isShot=!1,s){case ae:case le:var a=i.getNormalBulletNode(),l=a.getComponent(kn),u=this.getMuzzleWorldPos();a.setParent(Ce.node.bulletLayer),r.isShot=l.init(u,o.peekNextBulletID(),t,e,r.aimingID,(function(){i.putToNormalBulletPool(a)}));break;case ue:var c=i.getAxeBulletNode(),h=c.getComponent(De),p=this.getMuzzleWorldPos();c.setParent(Ce.node.bulletLayer),r.isShot=h.init(p,o.peekNextBulletID(),t,e,r.aimingID,this.axeHandSide,(function(){i.putToAxeBulletPool(c)}))}return r.isShot&&(r.bltID=o.newBulletID(),this.playShoot()),r},r.getMuzzleWorldPos=function(){switch(Ce.shootingMgr.shootMode){case ae:case le:return this.cannonNode.children[0].children[0].worldPosition;case ue:return this.axeThrowPivots[this.axeHandSide].worldPosition}},r.getShootWorldPosX=function(){switch(Ce.shootingMgr.shootMode){case ae:case le:return this.getMuzzleWorldPos().x;case ue:return this.node.parent.worldPosition.x}},r.isNeedTarget=function(){var t=Ce.shootingMgr.shootMode;return t!==ae&&(t===le||(t===ue||void 0))},r.getShootingCost=function(){var t=Ce.gameCtrl.getPlayerBet(),e=Ce.shootingMgr.shootMode;return e===ae||e===le?t*ce:e===ue?t*he:void 0},r.getCoolDownTime=function(){var t=Ce.shootingMgr.shootMode;return t===ae||t===le?.2:t===ue?.25:void 0},r.playIdle=function(){switch(Ce.shootingMgr.shootMode){case ae:Xt(this.node,"Cannon_Idle"),Xt(this.roleNode,"Cannon_Idle");break;case le:Xt(this.node,"Aim_Idle"),Xt(this.roleNode,"Aim_Idle");break;case ue:Xt(this.node,"Axe_Idle"),Xt(this.roleNode,"Axe_Idle")}},r.playShoot=function(){var t=this,e=k.WrapMode.Normal;switch(Ce.shootingMgr.shootMode){case ae:Xt(this.node,"Cannon_Attack"),Xt(this.roleNode,"Cannon_Attack",e,(function(){return t.playIdle()})),Xt(this.cannonNode,"",e),Xt(this.cannonGunFireNode),Xt(this.cannonTapOnNode),Ce.sndMgr.playOneShot("Shoot_Normal");break;case le:Xt(this.node,"Aim_Attack"),Xt(this.roleNode,"Aim_Attack",e,(function(){return t.playIdle()})),Xt(this.cannonNode,"",e),Xt(this.cannonGunFireNode),Xt(this.cannonTapOnNode),Ce.sndMgr.playOneShot("Shoot_Normal");break;case ue:var n=0===this.axeHandSide?"Axe_Attack_L":"Axe_Attack_R";Xt(this.node,n),Xt(this.roleNode,n,e,(function(){return t.playIdle()})),Ce.sndMgr.playOneShot("Shoot_Axe"),this.axeHandSide^=1}},r.playChangeFx=function(){var t=Vt(Ce.cam3D,Ce.cam2D,this.node.worldPosition);t.y+=50;var e=N(this.changeFxPrefab);e.setParent(Ce.node.effect2DLayer),e.setWorldPosition(t),Xt(e,"",null,(function(){e.destroy()}))},o}(g)).prototype,"normalCannonPivot",[Pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xn=t(Bn.prototype,"axeThrowPivots",[wn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_n=t(Bn.prototype,"normalCannonPrefab",[Sn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Rn=t(Bn.prototype,"changeFxPrefab",[Mn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tn=Bn))||Tn);s._RF.pop(),s._RF.push({},"1ffc26Wtj9PULuC9ZYwWo8L","RoleTurret",void 0);var Gn,Vn,Xn,Zn,qn,jn,Yn,Kn,Jn,Qn,$n,ti,ei,ni,ii,oi,ri,si,ai,li,ui,ci,hi,pi,di,fi,gi,mi,yi,vi=u.ccclass,bi=(u.property,vi("RoleTurret")(On=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).cannon=null,e.locked=!1,e}e(n,t);var i=n.prototype;return i.onLoad=function(){this.addCannon()},i.addCannon=function(){var t=this,e=Ce.node.cannonLayer.children[0],n=Ce.dataMgr.getQueenCannonNode();this.cannon=n.getComponent(Hn),n.setRotationFromEuler(0,180,0),n.setParent(e),te(this.node,(function(e){Ce.gameCtrl.isReadyToPlay()&&(t.cannon.equip(),e.stop())}))},i.moveToWorldPosX=function(t){var e=this.cannon.node.parent,n=e.worldPosition;e.setWorldPosition(t,n.y,n.z),this.showLocationHint(!1)},i.getWorldPos=function(){return this.cannon.node.parent.worldPosition},i.isLocked=function(){return this.locked},i.setLock=function(t){this.locked=t},i.showLocationHint=function(t){var e=Ce.uiCtrl.locationHintNode;if(e.active=t,t){var n=e.worldPosition,i=Vt(Ce.cam3D,Ce.cam2D,this.getWorldPos());e.setWorldPosition(i.x,n.y,n.z)}},n}(g))||On);s._RF.pop(),s._RF.push({},"98a8ceZmqJH7rt2sZa1J+Uo","PropertyRes",void 0);var Pi,wi=u.ccclass,Si=u.property,Mi=(Gn=wi("PropertyRes"),Vn=Si({type:R,tooltip:"玩家炮台的 Prefab"}),Xn=Si({type:R,tooltip:"一般子彈的 Prefab"}),Zn=Si({type:R,tooltip:"飛斧子彈的 Prefab"}),qn=Si({type:R,tooltip:"飛斧子彈軌跡的 Prefab"}),jn=Si({type:R,tooltip:"飛斧模型的 Prefab"}),Yn=Si({type:R,tooltip:"小金幣的 Prefab"}),Kn=Si({type:R,tooltip:"Boss 金幣的 Prefab"}),Jn=Si({type:R,tooltip:"獲獎金額數字的 Prefab"}),Qn=Si({type:R,tooltip:"未命中文字的 Prefab"}),$n=Si({type:R,tooltip:"Boss 來襲的 Prefab"}),ti=Si({type:R,tooltip:"水波的 Prefab"}),ei=Si({type:R,tooltip:"水花的 Prefab"}),ni=Si({type:[R],tooltip:"怪物的 Prefab"}),Gn((ri=t((oi=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"queenCannonPrefab",ri,i(e)),n(e,"normalBulletPrefab",si,i(e)),n(e,"axeBulletPrefab",ai,i(e)),n(e,"axeBulletTrackFxPrefab",li,i(e)),n(e,"axeModelPrefab",ui,i(e)),n(e,"smallCoinPrefab",ci,i(e)),n(e,"bossCoinPrefab",hi,i(e)),n(e,"winNumPrefab",pi,i(e)),n(e,"missTextPrefab",di,i(e)),n(e,"bossComingPrefab",fi,i(e)),n(e,"waterRipplePrefab",gi,i(e)),n(e,"waterSplashPrefab",mi,i(e)),n(e,"monsterPrefabs",yi,i(e)),e}return e(o,t),o}(g)).prototype,"queenCannonPrefab",[Vn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),si=t(oi.prototype,"normalBulletPrefab",[Xn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ai=t(oi.prototype,"axeBulletPrefab",[Zn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),li=t(oi.prototype,"axeBulletTrackFxPrefab",[qn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ui=t(oi.prototype,"axeModelPrefab",[jn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ci=t(oi.prototype,"smallCoinPrefab",[Yn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hi=t(oi.prototype,"bossCoinPrefab",[Kn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pi=t(oi.prototype,"winNumPrefab",[Jn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),di=t(oi.prototype,"missTextPrefab",[Qn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fi=t(oi.prototype,"bossComingPrefab",[$n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gi=t(oi.prototype,"waterRipplePrefab",[ti],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mi=t(oi.prototype,"waterSplashPrefab",[ei],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yi=t(oi.prototype,"monsterPrefabs",[ni],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ii=oi))||ii);s._RF.pop(),s._RF.push({},"1a13aE5xjZMs4t9B/A6DFt0","DataMgr",void 0);var Ti,Bi=u.ccclass;u.property,Bi("DataMgr")(Pi=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._res=null,e.normalBltPool=new W,e.axeBltPool=new W,e.axeBltTrackFxPool=new W,e.axeModelPool=new W,e.smallCoinPool=new W,e.bossCoinPool=new W,e.winNumPool=new W,e.missTextPool=new W,e.waterRipplePool=new W,e.waterSplashPool=new W,e.monsterPoolMap=new Map,e}e(n,t);var i=n.prototype;return i.onLoad=function(){Ce.dataMgr=this,this.freeOnStageDestroy((function(){return Ce.dataMgr=null})),this._res=this.getComponentInChildren(Mi)},i.onDestroy=function(){this.clearAllPools()},i.freeOnStageDestroy=function(t){O.once("__Free__",t)},i.clearAllPools=function(){this.normalBltPool.clear(),this.axeBltPool.clear(),this.axeBltTrackFxPool.clear(),this.axeModelPool.clear(),this.smallCoinPool.clear(),this.bossCoinPool.clear(),this.winNumPool.clear(),this.missTextPool.clear(),this.waterRipplePool.clear(),this.waterSplashPool.clear(),this.monsterPoolMap.forEach((function(t){return t.clear()})),this.monsterPoolMap.clear()},i.getQueenCannonNode=function(){return N(this._res.queenCannonPrefab)},i.getNormalBulletNode=function(){var t;return null!=(t=this.normalBltPool.get())?t:N(this._res.normalBulletPrefab)},i.putToNormalBulletPool=function(t){this.normalBltPool.put(t)},i.getAxeBulletNode=function(){var t;return null!=(t=this.axeBltPool.get())?t:N(this._res.axeBulletPrefab)},i.putToAxeBulletPool=function(t){this.axeBltPool.put(t)},i.getAxeBulletTrackFxNode=function(){var t;return null!=(t=this.axeBltTrackFxPool.get())?t:N(this._res.axeBulletTrackFxPrefab)},i.putToAxeBulletTrackFxPool=function(t){this.axeBltTrackFxPool.put(t)},i.getAxeModelNode=function(){var t;return null!=(t=this.axeModelPool.get())?t:N(this._res.axeModelPrefab)},i.putToAxeModelPool=function(t){this.axeModelPool.put(t)},i.getSmallCoinNode=function(){var t;return null!=(t=this.smallCoinPool.get())?t:N(this._res.smallCoinPrefab)},i.putToSmallCoinPool=function(t){this.smallCoinPool.put(t)},i.getBossCoinNode=function(){var t;return null!=(t=this.bossCoinPool.get())?t:N(this._res.bossCoinPrefab)},i.putToBossCoinPool=function(t){this.bossCoinPool.put(t)},i.getWinNumNode=function(){var t;return null!=(t=this.winNumPool.get())?t:N(this._res.winNumPrefab)},i.putToWinNumPool=function(t){this.winNumPool.put(t)},i.getMissTextNode=function(){var t;return null!=(t=this.missTextPool.get())?t:N(this._res.missTextPrefab)},i.putToMissTextPool=function(t){this.missTextPool.put(t)},i.getWaterRippleNode=function(){var t;return null!=(t=this.waterRipplePool.get())?t:N(this._res.waterRipplePrefab)},i.putToWaterRipplePool=function(t){this.waterRipplePool.put(t)},i.getWaterSplashNode=function(){var t;return null!=(t=this.waterSplashPool.get())?t:N(this._res.waterSplashPrefab)},i.putToWaterSplashPool=function(t){this.waterSplashPool.put(t)},i.getMonsterNode=function(t){var e,n=this._res.monsterPrefabs;if(t<=0||t>=n.length)return null;var i=this.monsterPoolMap,o=i.get(t);return o||(o=new W,i.set(t,o)),null!=(e=o.get())?e:N(n[t])},i.putToMonsterPool=function(t,e){var n=this.monsterPoolMap.get(e);n?n.put(t):t.destroy()},o(n,[{key:"res",get:function(){return this._res}}]),n}(g));s._RF.pop(),s._RF.push({},"f7368jQW95DXJ73KtTLgq69","EffectMgr",void 0);var Ci,xi=v(),_i=k.WrapMode,Ri=u.ccclass;u.property,Ri("EffectMgr")(Ti=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onLoad=function(){Ce.effectMgr=this,Ce.dataMgr.freeOnStageDestroy((function(){return Ce.effectMgr=null}))},i.showBossComing=function(t,e){var n=N(Ce.dataMgr.res.bossComingPrefab);n.setParent(Ce.node.noticeLayer),se(n,"Node_1/bar/OddsNum",U).string=Jt(t),Ce.sndMgr.playOneShot("Boss_Coming"),Xt(n,"",null,(function(){n.destroy(),null==e||e()}))},i.showGetCoins=function(t,e,n,i){for(var o=Ce.dataMgr,r=Ce.node.effect3DLayer,s=M.randomRange,a=function(t){return function(e){var n=2*e;return n<1?.5*Math.pow(n,t):1-.5*Math.pow(2-n,t)}}(2),l=de.opts.easeIn_2,u=de.opts.easeOut_2,c={position:v(0,0,0)},h={position:v(0,20,0)},p=L.distance(t,e)/1500,d=qt(4,7),f=function(n){var f=o.getSmallCoinNode();f.setParent(r),f.setWorldPosition(t.x+s(-50,50),t.y,t.z+s(-50,50));var g=f.children[0];g.setPosition(0,-1e3,0);var m=s(200,320),y=s(70,120);T(g).delay(s(0,.3)).set(c).to(.01*s(25,40),{position:v(0,m,0)},u).to(.01*s(20,30),c,l).to(.01*s(20,30),{position:v(0,y,0)},u).to(.01*s(20,30),c,l).to(.1,h,u).to(.1,c,l).start();var b=n===d,P=v(f.worldPosition),w=e;T(f).delay(2).by(p,de.props.empty,{onUpdate:function(t,e){var n=a(e);g.setWorldPosition(B(P.x,w.x,n),B(P.y,w.y,n),B(P.z,w.z,n))}}).call((function(){if(g.setPosition(0,0,0),A.stopAllByTarget(g),o.putToSmallCoinPool(f),b){var t=Math.min(5,qt(1,d));ee(Ce.gameCtrl.timer,.08,t,(function(){Ce.sndMgr.playOneShot("Collect_01")})),null==i||i()}})).start()},g=1;g<=d;++g)f(g);if(n>0){var m=Vt(Ce.cam3D,Ce.cam2D,t,xi);m.x+=40,m.y-=40,this.showWinNum(m,n)}},i.showBossGetCoins=function(t,e,n){var i=Ce.dataMgr,o=Ce.node.effect2DLayer,r=i.getBossCoinNode();if(r.setParent(o),r.setWorldPosition(t),Ce.sndMgr.playOneShot("Collect_02"),Xt(r,"",_i.Normal,(function(){i.putToBossCoinPool(r),null==n||n()})),e>0){var s=xi.set(t);s.x+=80,s.y-=80,this.showWinNum(s,e)}},i.showWinNum=function(t,e){if(!(e<=0)){var n=Ce.dataMgr,i=Ce.node.rewardLayer,o=n.getWinNumNode();o.setParent(i),o.setWorldPosition(t),o.getComponentInChildren(U).string="+"+Jt(e),$t(o,.2,1,255,Qt(1.5)).start(),T(o).by(.9,{position:v(0,M.randomRange(70,110),0)},de.opts.easeOut_2).delay(.5).call((function(){$t(o,.4,-1,0,Qt(1.5)).call((function(){A.stopAllByTarget(o),n.putToWinNumPool(o)})).start()})).start()}},i.showMissText=function(t){var e=Ce.dataMgr,n=Ce.node.rewardLayer,i=e.getMissTextNode();i.setParent(n),i.setWorldPosition(t),$t(i,.2,1,255,Qt(1.5)).start(),T(i).by(.6,{position:v(0,M.randomRange(50,90),0)},de.opts.easeOut_2).delay(.3).call((function(){$t(i,.3,-1,0,Qt(1.5)).call((function(){A.stopAllByTarget(i),e.putToMissTextPool(i)})).start()})).start()},i.playWaterSplashFx=function(t,e,n){void 0===n&&(n=!0);var i=Ce.dataMgr,o=Ce.node.waterLayer,r=new x("WaterSplashFx");r.layer=o.layer,r.setParent(o),r.setWorldPosition(t),r.setScale(e,e,e);var s=M.randomRange;if(ee(r,.1,4,(function(){var t=s(1,1.5),e=i.getWaterRippleNode();e.setParent(r),e.setPosition(s(-10,10),0,s(-10,10)),e.setScale(s(1,1.2),1,s(1,1.2)),e.setRotationFromEuler(0,s(0,360),0);var n=s(20,45)*(Math.random()>.5?1:-1);T(e).by(.8,{eulerAngles:v(0,n,0)}).start(),T(e.getComponent(kt)).set(de.props.opacity_255).delay(.35/t).to(1.5/t,de.props.opacity_0).start(),T(e).to(2/t,{scale:v(e.scale).multiplyScalar(2)}).call((function(){A.stopAllByTarget(e),i.putToWaterRipplePool(e)})).start()})),n){Ce.sndMgr.playOneShot("Water_Splash_Small");var a=0;ee(r,.0333,4,(function(){var t=s(1,1.5),e=i.getWaterSplashNode();e.setParent(r);var n=M.randomRangeInt(0,e.children.length);switch(e.children.forEach((function(t,e){return t.active=e===n})),a++){case 0:e.setPosition(s(-10,0),0,s(0,10));break;case 1:e.setPosition(s(0,10),0,s(0,10));break;case 2:e.setPosition(s(-10,0),0,s(-10,0));break;case 3:e.setPosition(s(0,10),0,s(-10,0))}T(e.getComponent(kt)).set(de.props.opacity_255).delay(.3/t).to(.4/t,de.props.opacity_0).start(),T(e).to(.2/t,{scale:v(1.2,2,1),position:v(0,20,0).add(e.position)}).to(.8/t,{scale:v(.66,1,1),position:v(0,-50,0).add(e.position)}).call((function(){A.stopAllByTarget(e),i.putToWaterSplashPool(e)})).start()}))}ie(r,2,(function(){r.destroy()}))},i.makeMonsterFly=function(t,e,n){for(var i,o=M.randomRange,s=v(),a=v(),l=v(),u=function(){var e=i.value;if(!e.isUsing()||!e.node)return"continue";e.stopMove(),e.setUsing(!1),e.colliders.forEach((function(t){return t.enabled=!1})),Ce.monsterMgr.removeFromEntitiesMap(e.getID());var r=0;l.set(e.node.worldPosition).subtract(t),l.normalize().multiplyScalar(o(500,600));var u=v(l.x,o(750,900),l.z),c=v(o(-60,60),o(-60,60),o(-60,60));Ce.sndMgr.playOneShot(e.getHurtSndName()),null==n||n(e);var h=e.node;te(h,(function(t){var n=Math.min(.1,H.deltaTime);if(r>=3.5)return t.stop(),void e.pushToPool();s.set(u).multiplyScalar(n).add(h.position),a.set(c).multiplyScalar(n).add(h.eulerAngles),h.setRotationFromEuler(a),h.setPosition(s),u.y+=-2e3*n,r+=n}))},c=r(e);!(i=c()).done;)u()},i.getWaterHeight=function(){return Ce.node.waterLayer.worldPosition.y-28},n}(g));s._RF.pop(),s._RF.push({},"495daYmr7pLHaRJnstXPUSd","GameCtrl",void 0);var Fi,Ni=u.ccclass;u.property,Ni("GameCtrl")(Ci=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).isInit=!1,e.playerTurret=null,e.playerCoins=0,e.betIndex=0,e.betList=[0],e.walletBuffer=0,e.RTP=.97,e}e(n,t);var i=n.prototype;return i.onLoad=function(){Ce.gameCtrl=this,Ce.dataMgr.freeOnStageDestroy((function(){return Ce.gameCtrl=null})),this.playerTurret=this.getComponentInChildren(bi),this.devTestInit(),a.isBrowser&&a.isMobile&&a.os!==a.OS.IOS&&ne(this.node,2.5,(function(){document.fullscreenElement||document.documentElement.requestFullscreen()}))},i.onDestroy=function(){A.stopAllByTarget(this.node),Ce.shootingMgr.onCancelShootFunc=null},i.start=function(){this.gameInit()},i.gameInit=function(){var t=this,e=Ce.uiCtrl.blackScreenNode;e.active=!0,ie(this.node,0,(function(){t.joinTable(),t.isInit=!0,$t(e,.7,255,0,Qt(1.5)).call((function(){re(e,255),e.active=!1})).start()}))},i.joinTable=function(){var t=this;this.betList.length=0,this.betList.push(1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100),this.betIndex=0,this.playerCoins=1e4,this.playerTurret.showLocationHint(!0),Ce.uiCtrl.setSessionText(qt(1e4,99999)),Ce.uiCtrl.updatePlayerCoins(),Ce.uiCtrl.updatePlayerBet(),Ce.shootingMgr.onCancelShootFunc=function(e,n,i,o){t.addPlayerCoins(o),Ce.uiCtrl.updatePlayerCoins()},Ce.setValue("Main_BGM","BGM_01"),Ce.sndMgr.playMusic("BGM_01",!0)},i.checkKill=function(t,e){for(var n,i=Math.random,o=this.RTP/t.getOdds(),r=(n=e.type)===ae||n===le?1:n===ue?5:1,s=0,a=!1,l=0;l<r;++l)if(++s,i()<o){a=!0;break}if(s<r){var u=(r-s)/r*e.cost;this.walletBuffer+=u}if(!a&&this.walletBuffer>=e.bet)for(var c=e.bet,h=Math.floor(this.walletBuffer/c),p=0;p<h;++p)if(this.walletBuffer-=c,i()<o){a=!0;break}return a},i.getPlayerTurret=function(){return this.playerTurret},i.getPlayerBet=function(){return this.betList[this.betIndex]},i.getPlayerCoins=function(){return this.playerCoins},i.addPlayerCoins=function(t){var e=Math.max(0,this.playerCoins+t);return this.playerCoins=e,e},i.getBetList=function(){return this.betList},i.setBetIndex=function(t){var e=this.betList.length-1;return this.betIndex=f(t,0,e)},i.getBetIndex=function(){return this.betIndex},i.isReadyToPlay=function(){return this.isInit},i.devTestInit=function(){var t=this;It.isDevTest&&(G.on(V.EventType.KEY_DOWN,this.keyDownTest,this),Ce.dataMgr.freeOnStageDestroy((function(){G.off(V.EventType.KEY_DOWN,t.keyDownTest,t)})))},i.keyDownTest=function(t){switch(t.keyCode){case X.F4:var e=Ce.shootingMgr.getCoolDownRate();Ce.shootingMgr.setCoolDownRate(e<=1?3:1);break;case X.SPACE:}},o(n,[{key:"timer",get:function(){return this.node}}]),n}(g));s._RF.pop(),s._RF.push({},"60cddKwsYdEB4ZLq3a5U+nO","Initializer",void 0);var Ai,Di=u.ccclass;u.property,Di("Initializer")(Fi=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onLoad=function(){this.init(),this.freeOnStageDestroy()},i.init=function(){var t=Ce.node;t.stage=se("Canvas/Stage"),t.display=se(t.stage,"Display"),t.scene=se(t.display,"Scene"),t.ui=se(t.display,"UI");var e=t.scene;t.riverLayer=se(e,"RiverLayer"),t.waterLayer=se(e,"WaterLayer"),t.landLayer=se(e,"LandLayer"),t.cannonLayer=se(e,"CannonLayer"),t.bulletLayer=se(e,"BulletLayer"),t.enemyLayer=se(e,"EnemyLayer"),t.effect3DLayer=se(e,"EffectLayer");var n=t.ui;t.touchPanel=se(n,"TouchPanel"),t.effect2DLayer=se(n,"EffectLayer"),t.playerLayer=se(n,"PlayerLayer"),t.buttonLayer=se(n,"ButtonLayer"),t.rewardLayer=se(n,"RewardLayer"),t.noticeLayer=se(n,"NoticeLayer"),t.uiLayer=se(n,"UILayer"),Ce.cam2D=se(t.stage,"Camera/UI Camera",q),Ce.cam3D=se(t.stage,"Camera/3D Camera",q)},i.freeOnStageDestroy=function(){var t=this,e=x.EventType.NODE_DESTROYED;Ce.node.stage.once(e,(function(){var n=new x("_");n.layer=Z.Enum.NONE,n.setParent(Ce.node.stage),n.once(e,(function(){O.emit("__Free__"),t.free()}))}))},i.free=function(){var t=Ce.node;Object.keys(t).forEach((function(e){t[e]=null})),Ce.cam2D=null,Ce.cam3D=null},n}(g));s._RF.pop(),s._RF.push({},"1fa10p2fVpLhbtMp8tgHSbs","MonsterMgr",void 0);var Ii,Ei=u.ccclass;u.property,Ei("MonsterMgr")(Ai=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).entities=new Map,e}e(n,t);var i=n.prototype;return i.onLoad=function(){Ce.monsterMgr=this,Ce.dataMgr.freeOnStageDestroy((function(){return Ce.monsterMgr=null}))},i.onDestroy=function(){this.entities.clear()},i.addEntity=function(t,e,n){var i,o=null==(i=Ce.dataMgr.getMonsterNode(t))?void 0:i.getComponent(vn);if(!o)return p("Monster adding failed. No: "+t+", ID: "+e+"."),null;var r=this.entities;if(r.has(e))return p("Monster already exists. ID: "+e+"."),Ce.dataMgr.putToMonsterPool(o.node,t),null;var s=o.node;return s.name="Monster_"+e,s.setParent(Ce.node.enemyLayer),o.init(t,e),o.setMovePath(n)?(o.postInit(),r.set(e,o),o):(p("Monster has no path. PathNo: "+n+"."),Ce.dataMgr.putToMonsterPool(o.node,t),null)},i.entityOnHit=function(t,e){if(Ce.gameCtrl.checkKill(t,e)){var n=t.getOdds()*e.bet;t.showReward(n)||(Ce.gameCtrl.addPlayerCoins(n),Ce.uiCtrl.updatePlayerCoins()),t.showDeath()}},i.removeFromEntitiesMap=function(t){var e,n=this.entities,i=null!=(e=n.get(t))?e:null;return i&&n.delete(t),i},i.clearAllEntities=function(){var t=this.entities;Array.from(t.values()).forEach((function(t){return t.pushToPool()})),t.clear()},i.getEntitiesMap=function(){return this.entities},i.getAllEntities=function(t){var e=this.entities;if(t){for(var n,i=r(e.values());!(n=i()).done;){var o=n.value;t.push(o)}return t}return Array.from(e.values())},i.getEntitiesInRange=function(t,e,n,i){void 0===n&&(n=-1);var o=this.getAllEntities(),r=e*e;i||(i=function(t){return t.isNormalMonster&&t.isUsing()});for(var s=0;s<o.length;){var a=o[s];if(L.squaredDistance(t,a.node.worldPosition)>r||!i(a)){if(o.length>=2){var l=o.length-1,u=[o[l],o[s]];o[s]=u[0],o[l]=u[1]}o.pop()}else++s}if(function(t){var e=t.length;if(e>=2)for(var n=Math.floor,i=Math.random,o=e-1;o>0;--o){var r=n(i()*(o+1)),s=[t[r],t[o]];t[o]=s[0],t[r]=s[1]}}(o),n>0)for(var c=0,h=0,p=o.length;h<p;++h){if((c+=o[h].getOdds())>=n){o.length=h+1;break}}return o},i.getEntityByID=function(t){var e;return null!=(e=this.entities.get(t))?e:null},n}(g));s._RF.pop(),s._RF.push({},"aed29q0X5NEnqte/Iy6p1vR","ShootingMgr",void 0);var zi,Li,ki,Oi,Wi,Ui,Hi,Gi=new Array,Vi=function(t){return Gi.push(t)},Xi=function(){var t;return null!=(t=Gi.pop())?t:v()},Zi=u.ccclass;u.property,Zi("ShootingMgr")(Ii=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).onCancelShootFunc=null,e.shootMode=ae,e.isAiming=!1,e.isPressing=!1,e.shootWorldPos=v(),e.sightUINode=null,e.sightAimUINode=null,e.lastAimingNo=-1,e.lastAimingID=-1,e.aimTarget=null,e.tmpRaycastResults=[],e.tmpShootRecord={bltID:0,bltBet:0,bltCost:0,aimingID:0,shootMode:0,isShot:!1},e.coolDownTimer=9999,e.coolDownRate=1,e.nextBltID=1,e}e(n,t);var i=n.prototype;return i.onLoad=function(){Ce.shootingMgr=this,Ce.dataMgr.freeOnStageDestroy((function(){return Ce.shootingMgr=null}));var t=Ce.node.playerLayer;this.sightUINode=se(t,"UI/Aim/Sight"),this.sightAimUINode=se(t,"UI/Aim/Sight_Aim")},i.onDestroy=function(){this.onCancelShootFunc=null,this.aimTarget=null},i.update=function(t){Ce.gameCtrl.isReadyToPlay()&&this.updateShootingStates(t)},i.start=function(){this.init()},i.init=function(){var t=this;te(this.node,(function(e){if(Ce.gameCtrl.isReadyToPlay()){var n=Ce.gameCtrl.getPlayerTurret();t.coolDownTimer=n.cannon.getCoolDownTime(),t.touchPanelSetup(),e.stop()}}))},i.touchPanelSetup=function(){var t=this,e=Ce.node.touchPanel,n=x.EventType,i=v(),o=v();e.on(n.TOUCH_START,(function(e){t.setTouchToShoot(!0),t.updateTouchPos(n.TOUCH_START,Ht(e,i),Gt(e,o))})),e.on(n.TOUCH_MOVE,(function(e){t.setTouchToShoot(!0),t.updateTouchPos(n.TOUCH_MOVE,Ht(e,i),Gt(e,o))})),e.on(n.TOUCH_END,(function(e){t.setTouchToShoot(!1)})),e.on(n.TOUCH_CANCEL,(function(e){t.setTouchToShoot(!1)}))},i.updateTouchPos=function(t,e,n){if(function(t,e,n,i){var o=t.screenPointToRay(e.x,e.y,Ot),r=o.o,s=o.d;if(0!==s.y){var a=(n-r.y)/s.y;if(a>=0)return i.set(s).multiplyScalar(a).add(r),!0}}(Ce.cam3D,e,0,this.shootWorldPos),this.sightUINode.setWorldPosition(n),Ce.gameCtrl.getPlayerTurret().cannon.isNeedTarget()){var i=this.aimTarget,o=this.getTargetByRayCasting(e);if(this.isAiming){if(t===x.EventType.TOUCH_START){o&&(this.aimTarget=o),this.isAiming&&i===o&&i&&o&&this.aimReset();var r=this.aimTarget;if(r){var s=r.node.worldPosition;this.shootWorldPos.set(s)}}}else{var a=this.aimTarget=o;if(a){var l=a.node.worldPosition;this.shootWorldPos.set(l)}}}else this.aimTarget=null},i.setTouchToShoot=function(t){this.sightUINode.active=t,this.isPressing=t},i.getTargetByRayCasting=function(t){var e=z.PhysicsGroup;if(this.tmpRaycastResults.length=0,!function(t,e,n,i){var o=t.screenPointToRay(e.x,e.y,Ot),r=w.instance.raycast(o,n);if(r)for(var s=w.instance.raycastResults,a=0,l=s.length;a<l;++a){var u=s[a];i.push(u.collider.node)}return r}(Ce.cam3D,t,e.MONSTER,this.tmpRaycastResults))return null;for(var n,i=null,o=r(this.tmpRaycastResults);!(n=o()).done;){var s=n.value.getComponent(vn);if(s&&s.isUsing()){i=s;break}}return this.tmpRaycastResults.length=0,i},i.setSightAimUIPos=function(t){var e=Xi();Vt(Ce.cam3D,Ce.cam2D,t,e),this.sightAimUINode.setWorldPosition(e),Vi(e)},i.playSightAimUIAiming=function(){var t=this;this.sightAimUINode.active&&Xt(this.sightAimUINode,"Sight_Aim",null,(function(){Xt(t.sightAimUINode,"Sight_Aim_Loop")}))},i.updateShootingStates=function(t){this.coolDownTimer=this.coolDownTimer-t*this.coolDownRate,this.coolDownTimer=Math.max(0,this.coolDownTimer),this.isAiming&&-1===this.getAimingID()&&(this.sightAimUINode.active=!1,this.aimTarget=null);var e=Ce.gameCtrl.getPlayerTurret();if(e.isLocked())this.sightAimUINode.active=!1;else{var n=this.isAiming&&e.cannon.isNeedTarget();if(this.sightAimUINode.active&&this.aimTarget){var i=Xi();this.getAimingWorldPos(this.aimTarget,i),this.setSightAimUIPos(i),Vi(i),this.checkShootRangeByPos2D(this.sightAimUINode.position)||(this.sightAimUINode.active=!1,n&&(this.aimTarget=null))}this.coolDownTimer<=0&&(n?(this.aimTarget||this.searchAimTargetByNo(this.lastAimingNo))&&this.readyToShoot():this.isPressing&&this.readyToShoot())}},i.readyToShoot=function(){var t=Ce.gameCtrl,e=Ce.uiCtrl,n=t.getPlayerTurret();if(!n.isLocked()){var i=n.cannon.getShootingCost();if(i>t.getPlayerCoins())return e.toast.show("餘額不足，無法發射子彈！"),void(this.isAiming&&(this.sightAimUINode.active=!1,this.aimTarget=null));if(this.checkShootRangeByWorldPos3D(this.shootWorldPos)){var o=this.aimTarget,r=n.getWorldPos().x,s=r-n.cannon.getShootWorldPosX();o&&o.isUsing()?n.moveToWorldPosX(o.node.worldPosition.x+s):n.moveToWorldPosX(this.shootWorldPos.x+s);var a=t.getPlayerBet(),l=this.tmpShootRecord;if(n.cannon.tryToShoot(a,i,l),l.isShot){if(this.coolDownTimer=n.cannon.getCoolDownTime(),t.addPlayerCoins(-i),e.updatePlayerCoins(),this.isAiming){var u=Xi();this.getAimingWorldPos(o,u),this.shootWorldPos.set(u);var c=this.lastAimingID,h=o.getID();h!==c&&(this.lastAimingNo=o.getNo(),this.lastAimingID=h,this.sightAimUINode.active=!0,this.setSightAimUIPos(u),this.playSightAimUIAiming()),Vi(u)}}else n.moveToWorldPosX(r)}}},i.checkShootRangeByWorldPos3D=function(t){var e=Xi();Vt(Ce.cam3D,Ce.cam2D,t,e);var n=this.checkShootRangeByWorldPos2D(e);return Vi(e),n},i.checkShootRangeByWorldPos2D=function(t){var e,n,i,o,r=Xi();e=Ce.node.stage,(n=t)===(i=null!=(o=i=r)?o:v())&&(n=Wt.set(n)),(e.node?e:e.getComponent(P)).convertToNodeSpaceAR(n,i);var s=this.checkShootRangeByPos2D(r);return Vi(r),s},i.checkShootRangeByPos2D=function(t){var e=.45*oe(Ce.node.stage,-1,-1).width;return Math.abs(t.x)<e},i.getAimingWorldPos=function(t,e){var n=t.aimNodes,i=null!=e?e:v();if(0===n.length)return i.set(t.node.worldPosition);for(var o,s=r(n);!(o=s()).done;){var a=o.value;if(this.checkShootRangeByWorldPos3D(a.worldPosition))return i.set(a.worldPosition)}return i.set(n[0].worldPosition)},i.searchAimTargetByNo=function(t){if(-1!==t){for(var e,n=Xi(),i=Ce.monsterMgr.getEntitiesMap(),o=r(i.values());!(e=o()).done;){var s=e.value;if(s.getNo()===t&&s.isUsing()&&(this.getAimingWorldPos(s,n),this.checkShootRangeByWorldPos3D(n)))return this.shootWorldPos.set(n),this.aimTarget=s,this.isAiming&&(this.sightAimUINode.active=!0,this.setSightAimUIPos(n),t!==this.lastAimingNo&&this.playSightAimUIAiming()),Vi(n),!0}Vi(n)}return this.sightAimUINode.active=!1,this.aimTarget=null,!1},i.getAimingID=function(){if(!Ce.gameCtrl.getPlayerTurret().cannon.isNeedTarget())return-1;var t=this.aimTarget;return t&&t.isUsing()?t.getID():-1},i.aimReset=function(){this.sightAimUINode.active=!1,this.lastAimingNo=-1,this.lastAimingID=-1,this.aimTarget=null},i.cancelShoot=function(t,e,n,i){var o;null==(o=this.onCancelShootFunc)||o.call(this,t,e,n,i)},i.setCoolDownRate=function(t){this.coolDownRate=t},i.getCoolDownRate=function(){return this.coolDownRate},i.peekNextBulletID=function(){return this.nextBltID},i.newBulletID=function(){return++this.nextBltID},n}(g));s._RF.pop(),s._RF.push({},"819e0ivTqxPD46918g9gWGI","SoundMgr",void 0);var qi,ji,Yi,Ki,Ji,Qi,$i,to=u.ccclass,eo=u.property;zi=to("SoundMgr"),Li=eo({tooltip:"音樂所在的 Bundle 名稱"}),ki=eo({tooltip:"音效所在的資料夾名稱"}),zi((Ui=t((Wi=function(t){function r(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"bundleName",Ui,i(e)),n(e,"sndDir",Hi,i(e)),e.isMute=!1,e.musicVol=1,e.effectVol=1,e.__isMute=!1,e.__musicVol=1,e.__effectVol=1,e.sndMap=new Map,e.waitingList=new Map,e.audioSrcList=new Array,e.isBlockPlayEffect=!1,e}e(r,t);var s=r.prototype;return s.onLoad=function(){Ce.sndMgr=this,Ce.dataMgr.freeOnStageDestroy((function(){return Ce.sndMgr=null})),this.init()},s.onDestroy=function(){H.off(j.EVENT_SHOW,this.onShow,this),H.off(j.EVENT_HIDE,this.onHide,this),A.stopAllByTarget(this.node),this.audioSrcList.length=0,this.waitingList.clear(),this.sndMap.clear()},s.init=function(){this.preloadSndDir(this.sndDir,this.bundleName),this.audioSrcList.push(this.node.addComponent(Y)),this.audioSrcList.push(this.node.addComponent(Y)),this.audioSrcList.forEach((function(t){return t.playOnAwake=!1})),this.effectVolume=.75,this.musicVolume=.85,this.saveStates(),H.on(j.EVENT_SHOW,this.onShow,this),H.on(j.EVENT_HIDE,this.onHide,this),this.isBlockPlayEffect=!1,this.checkBrowserIssue()},s.checkBrowserIssue=function(){var t=this;if(a.isBrowser&&"FALSE"!==Ce.getValue("IsBlockPlayEffect")){this.isBlockPlayEffect=!0;document.addEventListener("pointerdown",(function(){t.isBlockPlayEffect=!1,Ce.setValue("IsBlockPlayEffect","FALSE")}),{once:!0})}},s.saveStates=function(){this.__isMute=this.isMute,this.__musicVol=this.musicVol,this.__effectVol=this.effectVol},s.onShow=function(){this.__isMute||(this.mute=!1),this.musicVolume=this.__musicVol,this.effectVolume=this.__effectVol},s.onHide=function(){this.saveStates(),this.isMute||(this.mute=!0)},s.preloadSndDir=function(t,e){var n=this,i={type:J,priority:-1};K.loadAny({dir:t,bundle:e},i,(function(t,e){if(t)p(t.message);else{var i=n.sndMap;e.forEach((function(t){var e=t.name;i.set(e,t),function(t){var e=n.waitingList;if(e.has(t)){var i=e.get(t);e.delete(t),i.forEach((function(t){"Music"===t.type&&n.playMusic(t.name,t.loop),"Effect"===t.type&&n.playEffect(t.name,t.loop,t.interrupt)}))}}(e)}))}}))},s.addToWaitingList=function(t){var e,n=t.name,i=this.waitingList,o=null!=(e=i.get(n))?e:[];i.set(n,o),o.push(t)},s.playMusic=function(t,e){if(""!==t){this.stopMusic();var n=this.sndMap.get(t);if(n){var i=this.audioSrcList[0];i.clip=n,i.loop=e,i.play()}else{this.addToWaitingList({type:"Music",name:t,loop:e,interrupt:!0})}}},s.playEffect=function(t,e,n,i){if(void 0===i&&(i=!1),""!==t){var o=this.sndMap.get(t);if(o){if(!this.isMute&&!this.isBlockPlayEffect)if(n||e){n&&this.stopEffect(t);var r=new x(t),s=r.addComponent(Y),a=this.isMute?0:this.effectVol;r.layer=Z.Enum.NONE,r.setParent(this.node),s.playOnAwake=!1,s.volume=a,s.clip=o,s.loop=e,s.play(),e||r.once(Y.EventType.ENDED,(function(){r.destroy()}))}else this.playOneShot(t)}else if(i){this.addToWaitingList({type:"Effect",name:t,loop:e,interrupt:n})}}},s.playOneShot=function(t){if(""!==t&&!this.isMute&&!this.isBlockPlayEffect){var e=this.sndMap.get(t);if(e)this.audioSrcList[1].playOneShot(e)}},s.stopMusic=function(){var t=this.audioSrcList[0];t.clip&&t.playing&&t.stop();var e=this.waitingList;Array.from(e.values()).forEach((function(t){"Music"!==t[0].type||e.delete(t[0].name)}))},s.stopEffect=function(t){for(var e=this.node.children,n=e.length-1;n>=0;--n){var i,o=e[n];if(o.name===t)null==(i=o.getComponent(Y))||i.stop(),o.destroy()}var r=this.waitingList;Array.from(r.values()).forEach((function(e){e[0].name!==t||"Effect"!==e[0].type||r.delete(e[0].name)}))},o(r,[{key:"musicVolume",get:function(){return this.musicVol},set:function(t){var e=this.isMute?0:t;this.musicVol=t,this.audioSrcList[0].volume=e}},{key:"effectVolume",get:function(){return this.effectVol},set:function(t){var e=this.isMute?0:t;this.effectVol=t,this.audioSrcList[1].volume=e;for(var n=this.node.children,i=n.length-1;i>=0;--i){n[i].getComponent(Y).volume=e}}},{key:"mute",get:function(){return this.isMute},set:function(t){this.isMute=t,this.musicVolume=this.musicVol,this.effectVolume=this.effectVol}}]),r}(g)).prototype,"bundleName",[Li],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"game"}}),Hi=t(Wi.prototype,"sndDir",[ki],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"res/sound"}}),Oi=Wi));s._RF.pop(),s._RF.push({},"8a9186QtEVL+a3eVbp8Y+OV","Toast",void 0);var no,io,oo,ro,so,ao,lo,uo,co,ho,po,fo,go,mo,yo,vo,bo,Po,wo,So,Mo,To,Bo,Co,xo,_o,Ro,Fo=u.ccclass,No=u.property,Ao=(qi=Fo("Toast"),ji=No(x),Yi=No(U),qi((Qi=t((Ji=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"pivotNode",Qi,i(e)),n(e,"contentText",$i,i(e)),e}e(o,t);var r=o.prototype;return r.onLoad=function(){this.pivotNode.active=!1},r.show=function(t){var e=this;this.pivotNode.active=!0,this.contentText.string=t,A.stopAllByTarget(this.pivotNode),re(this.pivotNode,255),ie(this.pivotNode,2,(function(){$t(e.pivotNode,.5,-1,0,Qt(2)).call((function(){return e.pivotNode.active=!1})).start()}))},r.hide=function(){A.stopAllByTarget(this.pivotNode),this.pivotNode.active=!1},r.setPosition=function(t){this.pivotNode.setPosition(t)},r.setWorldPosition=function(t){this.pivotNode.setWorldPosition(t)},o}(g)).prototype,"pivotNode",[ji],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$i=t(Ji.prototype,"contentText",[Yi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ki=Ji))||Ki);s._RF.pop(),s._RF.push({},"c35afVxNP9MhKZ3SNf03MsK","UICtrl",void 0);var Do=1,Io=2,Eo=u.ccclass,zo=u.property;no=Eo("UICtrl"),io=zo({type:x,tooltip:"炮台位置提示"}),oo=zo({type:U,tooltip:"遊戲局號文字"}),ro=zo({type:U,tooltip:"玩家的押注額文字"}),so=zo({type:U,tooltip:"玩家的剩餘財產文字"}),ao=zo({type:Q,tooltip:"押注額調整按鈕"}),lo=zo({type:Q,tooltip:"押注額調整按鈕"}),uo=zo({type:[Q],tooltip:"遊戲功能按鈕"}),co=zo({type:[x],tooltip:"遊戲功能按鈕的啟用效果"}),ho=zo({type:[x],tooltip:"遊戲功能按鈕的使用花費介面"}),po=zo({type:[x],tooltip:"遊戲功能按鈕的文字節點"}),fo=zo({type:x,tooltip:"全畫面的黑色遮罩"}),go=zo({type:Ao,tooltip:"Toast 文字框"}),no((vo=t((yo=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"locationHintNode",vo,i(e)),n(e,"sessionText",bo,i(e)),n(e,"playerBetText",Po,i(e)),n(e,"playerCoinsText",wo,i(e)),n(e,"minusBetBtn",So,i(e)),n(e,"plusBetBtn",Mo,i(e)),n(e,"lstFuncBtn",To,i(e)),n(e,"lstFuncBtnFx",Bo,i(e)),n(e,"lstFuncBtnCost",Co,i(e)),n(e,"lstFuncBtnName",xo,i(e)),n(e,"blackScreenNode",_o,i(e)),n(e,"toast",Ro,i(e)),e.minusBetTween=null,e.plusBetTween=null,e.coinUIWpos3D=v(320,320,700),e}e(o,t);var r=o.prototype;return r.onLoad=function(){Ce.uiCtrl=this,Ce.dataMgr.freeOnStageDestroy((function(){return Ce.uiCtrl=null}))},r.onDestroy=function(){var t,e;null==(t=this.minusBetTween)||t.stop(),null==(e=this.plusBetTween)||e.stop(),this.minusBetTween=null,this.plusBetTween=null},r.start=function(){this.init()},r.init=function(){var t=x.EventType.TOUCH_START,e=x.EventType.TOUCH_END,n=x.EventType.TOUCH_CANCEL;this.minusBetBtn.node.on(t,this.minusBetBtnOnClick,this),this.plusBetBtn.node.on(t,this.plusBetBtnOnClick,this),this.minusBetBtn.node.on(e,this.minusBetBtnOnClickEnd,this),this.plusBetBtn.node.on(e,this.plusBetBtnOnClickEnd,this),this.minusBetBtn.node.on(n,this.minusBetBtnOnClickEnd,this),this.plusBetBtn.node.on(n,this.plusBetBtnOnClickEnd,this);var i=Q.EventType.CLICK;this.lstFuncBtn[Do].node.on(i,this.axeBtnOnClick,this),this.lstFuncBtn[Io].node.on(i,this.aimBtnOnClick,this)},r.setSessionText=function(t){for(var e=[],n=0;n<18;++n)e.push("0123456789".charAt(M.pseudoRandomRangeInt(t,0,10))),t=M.pseudoRandomRangeInt(t,1e3,9999);this.sessionText.string=e.join("")},r.updatePlayerBet=function(){var t=Jt(Ce.gameCtrl.getPlayerBet());this.playerBetText.string=t,this.updateBetBtnStates(),this.updateFuncBtnCosts()},r.updatePlayerCoins=function(){var t=Jt(Ce.gameCtrl.getPlayerCoins());this.playerCoinsText.string=t},r.getPlayerCoinUIWpos3D=function(){return this.coinUIWpos3D},r.updateBetBtnStates=function(){var t=Ce.gameCtrl,e=t.getBetList(),n=t.getBetIndex(),i=12;0===n?i=6:n===e.length-1&&(i=9),this.minusBetBtn.interactable=!!(8&i),this.plusBetBtn.interactable=!!(4&i),this.minusBetBtn.node.children[0].active=!!(2&i),this.plusBetBtn.node.children[0].active=!!(1&i)},r.updateFuncBtnCosts=function(){var t=Ce.gameCtrl.getPlayerBet();this.updateFuncBtnCost(Do,t*he)},r.updateFuncBtnCost=function(t,e){var n=this.lstFuncBtnCost[t].children[0];if(n&&"Cost"===n.name){var i=n.getComponentInChildren(U);i&&(i.string=Jt(e))}},r.changePlayerBet=function(t){var e=Ce.gameCtrl,n=e.getBetIndex();return e.setBetIndex(n+t),e.getBetIndex()!==n&&(this.updatePlayerBet(),!0)},r.minusBetBtnOnClick=function(){var t=this;if(this.changePlayerBet(-1)&&Ce.sndMgr.playOneShot("Switch"),!this.minusBetTween&&!this.plusBetTween){var e=.333;this.minusBetTween=ne(this.node,.15,(function(){e<=0?t.minusBetBtnOnClick():e-=.15}))}},r.plusBetBtnOnClick=function(){var t=this;if(this.changePlayerBet(1)&&Ce.sndMgr.playOneShot("Switch"),!this.minusBetTween&&!this.plusBetTween){var e=.333;this.plusBetTween=ne(this.node,.15,(function(){e<=0?t.plusBetBtnOnClick():e-=.15}))}},r.minusBetBtnOnClickEnd=function(){var t;null==(t=this.minusBetTween)||t.stop(),this.minusBetTween=null},r.plusBetBtnOnClickEnd=function(){var t;null==(t=this.plusBetTween)||t.stop(),this.plusBetTween=null},r.setAxeBtnUIEnable=function(t){var e=Do;this.lstFuncBtnFx[e].children[0].active=t,this.lstFuncBtnCost[e].children[0].active=t,this.lstFuncBtnName[e].children[0].active=!t},r.setAimBtnUIEnable=function(t){var e=Io;this.lstFuncBtnFx[e].children[0].active=t},r.axeBtnOnClick=function(){var t=Do,e=!this.lstFuncBtnFx[t].children[0].active;this.setAxeBtnUIEnable(e),Ce.sndMgr.playOneShot("Switch");var n=Ce.shootingMgr,i=n.shootMode;n.shootMode=e?ue:ae,n.isAiming&&!e&&(n.shootMode=le),i!==n.shootMode&&Ce.gameCtrl.getPlayerTurret().cannon.equip()},r.aimBtnOnClick=function(){var t=Io,e=!this.lstFuncBtnFx[t].children[0].active;this.setAimBtnUIEnable(e),Ce.sndMgr.playOneShot("Switch");var n=Ce.shootingMgr;n.isAiming=e,n.aimReset();var i=n.shootMode;i===ae&&(n.shootMode=le),i===le&&(n.shootMode=ae),i!==n.shootMode&&Ce.gameCtrl.getPlayerTurret().cannon.equip()},o}(g)).prototype,"locationHintNode",[io],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bo=t(yo.prototype,"sessionText",[oo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Po=t(yo.prototype,"playerBetText",[ro],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wo=t(yo.prototype,"playerCoinsText",[so],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),So=t(yo.prototype,"minusBetBtn",[ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mo=t(yo.prototype,"plusBetBtn",[lo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),To=t(yo.prototype,"lstFuncBtn",[uo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Bo=t(yo.prototype,"lstFuncBtnFx",[co],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Co=t(yo.prototype,"lstFuncBtnCost",[ho],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),xo=t(yo.prototype,"lstFuncBtnName",[po],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_o=t(yo.prototype,"blackScreenNode",[fo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ro=t(yo.prototype,"toast",[go],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mo=yo));s._RF.pop(),s._RF.push({},"c766ebvMx1OTaSIDIUUswEm","MonsterNo",void 0);var Lo,ko,Oo,Wo,Uo,Ho,Go,Vo,Xo,Zo=1,qo=2,jo=3,Yo=4,Ko=5,Jo=6,Qo=7;s._RF.pop(),s._RF.push({},"2991e5Gy0hDpLbGuBo1iVlC","OnBoardMonster",void 0);var $o,tr=k.WrapMode,er=u.ccclass,nr=u.property,ir=(Lo=er("OnBoardMonster"),ko=nr({tooltip:"最大擊退距離"}),Oo=nr({tooltip:"最大擊退次數"}),Wo=nr({type:U,tooltip:"賠率的文字顯示"}),Lo((Go=t((Ho=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"hitBackMaxDist",Go,i(e)),n(e,"maxHitCnt",Vo,i(e)),n(e,"oddsText",Xo,i(e)),e.hitCnt=0,e.isDown=!1,e.isRevival=!1,e.canShowHurt=!0,e.monsterNode=null,e.commonAnim=null,e.boardAnim=null,e}e(o,t);var r=o.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this);var e=se(this.node,"RootNode");this.monsterNode=se(e,"MonsterNode"),this.commonAnim=se(e,S),this.boardAnim=se(this.monsterNode,"RootNode",S)},r.postInit=function(){var t=this;this.using=!1,this.revival(null,(function(){return t.playIdle()}))},r.pushToPool=function(){this.stopFloating(),t.prototype.pushToPool.call(this)},r.playIdle=function(){var t=this.monsterAnims;if(Math.random()<.5)Xt(t[0],"idle01");else{var e=jt(["idle02","idle03"]);Xt(t[0],e,tr.Normal,(function(){Xt(t[0],"idle01")}))}},r.revival=function(t,e){var n=this;if(!this.isRevival){this.using=!1,this.isDown=!0,this.isRevival=!0,this.canShowHurt=!1,this.hitCnt=0,this.monsterNode.setPosition(0,0,0);var i=this.commonAnim,o=this.monsterAnims[0];o.node.setPosition(0,-5e3,0),Xt(i,"CommonIdle"),Xt(i,"CommonRevival",null,(function(){Xt(o,"ingame",tr.Normal,(function(){null==e||e()})),ie(o.node,0,(function(){o.node.setPosition(0,0,0),n.showFloating(),n.colliders.forEach((function(t){return t.enabled=!0})),n.canShowHurt=!0,n.isRevival=!1,n.isDown=!1,n.using=!0,null==t||t()}))}))}},r.showFloating=function(){this.stopFloating();var t=this.commonAnim.node;T(t).to(2,fe.props.positions[0]).to(2,fe.props.positions[1]).to(2,fe.props.positions[2]).to(2,fe.props.positions[3]).union().repeatForever().tag(501).start(),T(t).to(0,fe.props.angles[0]).to(1,fe.props.angles[1]).to(4,fe.props.angles[2]).to(3,fe.props.angles[3]).union().repeatForever().tag(502).start()},r.stopFloating=function(){var t=this.commonAnim.node;A.stopAllByTag(501,t),A.stopAllByTag(502,t)},r.showHurt=function(t){this.showHitBack(t)},r.showHitBack=function(t){var e=this;if(this.canShowHurt&&this.using){this.hitCnt=f(this.hitCnt+t,0,this.maxHitCnt),this.damageTint(!0);var n=this.hitCnt,i=this.maxHitCnt,o=this.boardAnim,r=this.monsterAnims,s=n/i;if(s>=1)return this.monsterNode.setPosition(0,0,-this.hitBackMaxDist),Math.random()<.5&&Ce.sndMgr.playOneShot(this.getHurtSndName()),Xt(o,"BoardDown",null,(function(){e.playIdle()})),void Xt(r[0],"up01",tr.Normal,(function(){Xt(r[0],"up02")}));var a=Math.random()>.3?"hit":"super_hit",l=B(0,this.hitBackMaxDist,s);this.monsterNode.setPosition(0,0,-l),Math.random()<.5&&Ce.sndMgr.playOneShot(this.getHurtSndName()),Xt(o,"BoardShake"),Xt(r[0],a,tr.Normal,(function(){e.playIdle()}))}},r.showReward=function(t){this.using=!1,this.canShowHurt=!1,this.colliders.forEach((function(t){return t.enabled=!1}));var e=Ce.effectMgr,n=e.getWaterHeight(),i=Ce.uiCtrl.getPlayerCoinUIWpos3D(),o=v(this.node.worldPosition);return o.y=n,o.z+=40,e.showGetCoins(o,i,t,(function(){Ce.gameCtrl.addPlayerCoins(t),Ce.uiCtrl.updatePlayerCoins()})),!0},r.showDeath=function(){var t=this;this.using=!1,this.isDown=!0,this.canShowHurt=!1,this.stopFloating(),Xt(this.boardAnim,"BoardIdle"),Xt(this.commonAnim,"CommonDead"),Ce.sndMgr.playOneShot(this.getHurtSndName());var e=Ce.effectMgr,n=Ce.effectMgr.getWaterHeight(),i=this.node,o=this.monsterAnims,r=this.colliders;ie(i,.73,(function(){var t=v(o[0].node.worldPosition);t.y=n,e.playWaterSplashFx(t,r[0].size.x/55)})),ie(i,1,(function(){var t=v(i.worldPosition);t.y=n,e.playWaterSplashFx(t,1,!1)})),ie(i,3,(function(){t.revival(null,(function(){return t.playIdle()}))}))},r.getHurtSndName=function(){switch(this.no){case Zo:case Ko:return"Monster_Hurt_0"+qt(1,5);case qo:case jo:case Yo:return"Male_Hurt_0"+qt(1,4);case Jo:return"Female_Hurt_0"+qt(1,2)}return""},o}(vn)).prototype,"hitBackMaxDist",[ko],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),Vo=t(Ho.prototype,"maxHitCnt",[Oo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Xo=t(Ho.prototype,"oddsText",[Wo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Uo=Ho))||Uo);s._RF.pop(),s._RF.push({},"16bd5NllD5DuKZStp5WqkbH","Shake2D",void 0);var or,rr,sr,ar,lr,ur,cr,hr,pr,dr=(0,u.ccclass)("Shake2D")($o=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).shakingTween=null,e.endTween=null,e.oldPos=null,e}return e(n,t),n}(g))||$o,fr={},gr=new Array(36);function mr(t,e,n,i,o){var r;if(void 0===o&&(o=1),t.activeInHierarchy){var s=t.getComponent(dr);s&&yr(t,s),e=Math.max(0,e),n=Math.floor(Math.max(1,n));var a=gr[M.randomRangeInt(0,gr.length)],l=v(t.position),u=v(l),c=v(a).multiplyScalar(i).add(l),h=1/n,p=0,d=i,f=T(t).by(e,fr,{onUpdate:function(n,i){var r=e*i/h,s=Math.floor(r);if(s>p){var a=gr[M.randomRangeInt(0,gr.length)];p=s,d*=o,u.set(c),c.set(a).multiplyScalar(d).add(l)}var f=r-s;t.setPosition(B(u.x,c.x,f),B(u.y,c.y,f))}}),g=T(t).delay(e).call((function(){return function(t){if(!t||!t.isValid)return;var e=t.getComponent(dr);e&&(yr(t,e),e.destroy())}(t)}));(s=null!=(r=s)?r:t.addComponent(dr)).shakingTween=f.start(),s.endTween=g.start(),s.oldPos=l}}function yr(t,e){var n,i;if(null==(n=e.shakingTween)||n.stop(),null==(i=e.endTween)||i.stop(),e.oldPos){var o=e.oldPos;t.setPosition(o.x,o.y)}e.shakingTween=null,e.endTween=null,e.oldPos=null}!function(){for(var t=2*Math.PI,e=0,n=gr.length;e<n;++e){var i=t*(e/n),o=L.rotateZ(v(),L.UP,L.ZERO,i);gr[e]=o}}(),s._RF.pop(),s._RF.push({},"9a717fq0whErYgz/TjM+b5x","BombGoblin",void 0);var vr,br,Pr,wr,Sr,Mr=k.WrapMode,Tr=u.ccclass,Br=u.property;or=Tr("BombGoblin"),rr=Br(x),sr=Br(R),ar=Br(R),or((cr=t((ur=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"lightBGNode",cr,i(e)),n(e,"explosionPrefab",hr,i(e)),n(e,"glassBrokenFxPrefab",pr,i(e)),e}e(o,t);var r=o.prototype;return r.init=function(e,n){t.prototype.init.call(this,e,n),this.oddsIndex=M.randomRangeInt(0,this.oddsList.length),this.oddsText.string="X"+Yt(this.oddsList)},r.revival=function(e,n){var i=this;this.oddsIndex=M.randomRangeInt(0,this.oddsList.length),this.lightBGNode.active=!1;t.prototype.revival.call(this,(function(){i.lightBGNode.active=!0,i.lightBGNode.getComponentsInChildren($).forEach((function(t){t.resetSystem(),t._simulator.step(0)})),null==e||e()}),n)},r.showReward=function(t){var e=this;this.using=!1,this.canShowHurt=!1,this.colliders.forEach((function(t){return t.enabled=!1})),Ce.monsterMgr.removeFromEntitiesMap(this.id);var n=this.node,i=N(this.explosionPrefab);i.setParent(Ce.node.effect3DLayer),i.setWorldPosition(this.node.worldPosition),Xt(i,"",Mr.Normal,(function(){i.destroy()})),ie(n,.65,(function(){mr(Ce.cam3D.node,1.3,25,10,.97)}));var o=Ce.effectMgr,r=o.getWaterHeight(),s=Ce.uiCtrl.getPlayerCoinUIWpos3D();return ie(n,.65,(function(){var t=e.node.worldPosition,n=Ce.monsterMgr.getEntitiesInRange(t,500,e.getOdds());o.makeMonsterFly(t,n,(function(t){var e=v(t.node.worldPosition);e.y=r,e.z+=40,ie(Ce.gameCtrl.timer,1.3,(function(){o.showGetCoins(e,s,0)}))})),ie(Ce.gameCtrl.timer,.3,(function(){Ce.sndMgr.playOneShot("Water_Splash_Small")}))})),this.stopFloating(),this.showBombGoblinFly(),ie(n,2,(function(){e.reuse=!1,Ce.sndMgr.playOneShot("Water_Splash_Small"),Xt(e.commonAnim,"NoFallDead",null,(function(){n.destroy()}));var i=v(n.worldPosition);i.y=r,i.z+=40,o.showGetCoins(i,s,t,(function(){Ce.gameCtrl.addPlayerCoins(t),Ce.uiCtrl.updatePlayerCoins()})),ie(n,.3,(function(){var t=v(n.worldPosition);t.y=r,o.playWaterSplashFx(t,2,!1)}))})),!0},r.showBombGoblinFly=function(){var t=this,e=this.monsterAnims,n=this.node;Xt(e[0],"idle01"),this.lightBGNode.active=!1,this.reuse=!1;var i=jt([-1400,1400])/1,o=0,r=20,s=!1;ie(n,.65,(function(){e[0].stop(),Ce.sndMgr.playOneShot("Boom_Fly");var a=se(e[0].node,"Bip001");T(a).to(.1,{position:v(0,M.randomRange(5,7),0)}).call((function(){te(n,(function(e){var n=Math.min(.1,H.deltaTime);if(o>=2.8)e.stop();else{if(o<1){var l=a.position,u=a.eulerAngles,c=a.scale.x+2*n;a.setScale(c,c,c),a.setPosition(l.x,l.y,l.z+25*n),a.setRotationFromEuler(u.x+i*n,u.y,u.z)}else if(o>=1&&!s){var h=Vt(Ce.cam3D,Ce.cam2D,a.worldPosition),p=N(t.glassBrokenFxPrefab);p.setParent(Ce.node.effect2DLayer),p.setWorldPosition(h),Xt(p,"",null,(function(){p.destroy()})),Ce.sndMgr.playOneShot("Glass_Broken"),s=!0}else if(o>1.8&&o<2.8){var d=a.position;a.setPosition(d.x,d.y-r*n,d.z),r+=70*n}o+=n}}))})).start()}))},r.showDeath=function(){},o}(ir)).prototype,"lightBGNode",[rr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hr=t(ur.prototype,"explosionPrefab",[sr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pr=t(ur.prototype,"glassBrokenFxPrefab",[ar],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lr=ur));s._RF.pop(),s._RF.push({},"92ddena355CAJX0VeNg/pt5","ClockTimerUI",void 0);var Cr,xr,_r,Rr,Fr,Nr,Ar,Dr=u.ccclass,Ir=u.property,Er=(vr=Dr("ClockTimerUI"),br=Ir(U),vr((Sr=t((wr=function(t){function r(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"timeText",Sr,i(e)),e.time=0,e}e(r,t);var s=r.prototype;return s.showFadeIn=function(t){$t(this.node,t,1,255,Qt(2)).start()},s.startTiming=function(t,e,n){var i=this;T(this.node).by(t,de.props.empty,{onUpdate:function(e,n){i.time=B(t,0,n),i.timeText.string=""+Math.ceil(i.time)}}).call((function(){null==e||e(),$t(i.node,.5,-1,0,Qt(2)).call((function(){return null==n?void 0:n()})).start()})).start()},o(r,[{key:"now",get:function(){return this.time}}]),r}(g)).prototype,"timeText",[br],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pr=wr))||Pr);s._RF.pop(),s._RF.push({},"54b3dZegeNNOrVwh3UnBfEW","GoldenGiant",void 0);var zr,Lr,kr,Or,Wr,Ur,Hr,Gr,Vr,Xr,Zr,qr=u.ccclass,jr=u.property,Yr=k.WrapMode;Cr=qr("GoldenGiant"),xr=jr(R),_r=jr(R),Cr((Nr=t((Fr=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"attackFxPrefab",Nr,i(e)),n(e,"clockTimerUIPrefab",Ar,i(e)),e.canShowHurt=!0,e.tagAttack=1247,e}e(o,t);var r=o.prototype;return r.postInit=function(){var t=this;this.using=!1,this.canShowHurt=!1;var e=Ce.effectMgr,n=this.monsterAnims,i=se(n[0],"Root/Bip001");ne(this.node,.75,(function(){e.playWaterSplashFx(i.worldPosition,M.randomRange(3.5,4.5),!1)})),Xt(n[0],"BossIngame",Yr.Normal,(function(){t.using=!0,t.playIdle()})),Ce.sndMgr.playMusic("BGM_Boss",!0),Ce.sndMgr.playOneShot("Water_Splash_Big"),ie(this.node,.333,(function(){var n=Ce.monsterMgr.getAllEntities().filter((function(e){return e.getID()!==t.id}));e.makeMonsterFly(i.worldPosition,n),mr(Ce.cam3D.node,1.2,25,10,.97),Ce.sndMgr.playOneShot("Giant_Water")})),ie(this.node,45,(function(){var e=N(t.clockTimerUIPrefab);e.setParent(Ce.node.noticeLayer),e.setPosition(0,270,0);var n=e.getComponent(Er);n.startTiming(15,(function(){return t.playDead()}),(function(){return n.destroy()})),n.showFadeIn(.5)}))},r.playIdle=function(){var t=this,e=this.monsterAnims;if(Math.random()<.6)this.canShowHurt=!0,Xt(e[0],"BossIdle01",Yr.Normal,(function(){t.playIdle()}));else{this.canShowHurt=!1;var n=jt(["BossIdle02","BossIdle03"]);Xt(e[0],n,Yr.Normal,(function(){t.playIdle()})),"BossIdle02"===n&&ie(this.node,.15,(function(){mr(Ce.cam3D.node,1,25,4,.97),Ce.sndMgr.playOneShot("Giant_Yell")})),"BossIdle03"===n&&ie(this.node,1.8,(function(){Ce.sndMgr.playOneShot("Giant_Head")}))}},r.playDead=function(){var t=this;this.using=!1,this.canShowHurt=!1,this.colliders.forEach((function(t){return t.enabled=!1})),this.stopMove(),Ce.monsterMgr.removeFromEntitiesMap(this.id),A.stopAllByTag(this.tagAttack,this.node),ie(this.node,2.8,(function(){mr(Ce.cam3D.node,1,25,6,.97),Ce.sndMgr.playOneShot("Giant_Water")})),Xt(this.monsterAnims[0],"BossDead",Yr.Normal,(function(){var e,n=null!=(e=Ce.getValue("Main_BGM"))?e:"";Ce.sndMgr.playMusic(n,!0),t.sinkAllEntities(),T(t.node.children[0]).by(.8,{position:v(0,-150,0)},{easing:Qt(2)}).call((function(){t.node.children[0].setPosition(0,0,0),t.pushToPool()})).start()}))},r.sinkAllEntities=function(){var t=this,e=Ce.effectMgr,n=Ce.effectMgr.getWaterHeight(),i=v();Ce.monsterMgr.getAllEntities().forEach((function(o){o.getID()!==t.id&&(o.stopMove(),o.setUsing(!1),o.colliders.forEach((function(t){return t.enabled=!1})),ie(o.node,.4,(function(){i.set(o.node.worldPosition),i.y=n,e.playWaterSplashFx(i,1,!1)})),T(o.node.children[0]).by(.8,de.props.position_0_n100_0).call((function(){o.node.children[0].setPosition(0,0,0),o.pushToPool()})).start())}))},r.showHurt=function(t){var e=this;if(this.using&&(this.damageTint(!0),this.canShowHurt))for(var n=this.monsterAnims,i=Math.min(t,3),o=0;o<i;++o)if(Math.random()<.15){Ce.sndMgr.playOneShot(this.getHurtSndName()),Xt(n[0],"BossHurt",Yr.Normal,(function(){e.playIdle()}));break}},r.showReward=function(t){var e=this;this.using=!1,this.canShowHurt=!1,this.colliders.forEach((function(t){return t.enabled=!1}));var n=this.monsterAnims,i=se(n[0],"Root/Bip001"),o=Vt(Ce.cam3D,Ce.cam2D,i.worldPosition);return o.y+=60,Ce.effectMgr.showBossGetCoins(o,t,(function(){Ce.gameCtrl.addPlayerCoins(t),Ce.uiCtrl.updatePlayerCoins()})),Ce.sndMgr.playOneShot(this.getHurtSndName()),Xt(n[0],"BossAttack",Yr.Normal,(function(){e.using=!0,e.canShowHurt=!0,e.colliders.forEach((function(t){return t.enabled=!0})),e.playIdle()})),A.stopAllByTag(this.tagAttack,this.node),T(this.node).delay(1.4).call((function(){var t=N(e.attackFxPrefab),n=t.scale;t.setParent(Ce.node.effect3DLayer),t.setScale(n.x,-n.y,n.z),Xt(t,"",Yr.Normal,(function(){return t.destroy()})),Ce.sndMgr.playOneShot("Giant_Attack"),ie(e.node,.1,(function(){var t=Ce.monsterMgr.getAllEntities().filter((function(t){return t.getID()!==e.id})).filter((function(t){return t.node.position.x<0}));Ce.effectMgr.makeMonsterFly(i.worldPosition,t),mr(Ce.cam3D.node,.8,25,5),ie(Ce.gameCtrl.timer,.3,(function(){Ce.sndMgr.playOneShot("Water_Splash_Big")}))}))})).delay(.6).call((function(){var t=N(e.attackFxPrefab);t.setParent(Ce.node.effect3DLayer),Xt(t,"",Yr.Normal,(function(){return t.destroy()})),ie(e.node,.1,(function(){var t=Ce.monsterMgr.getAllEntities().filter((function(t){return t.getID()!==e.id})).filter((function(t){return t.node.position.x>0}));Ce.effectMgr.makeMonsterFly(i.worldPosition,t),mr(Ce.cam3D.node,.8,25,5),ie(Ce.gameCtrl.timer,.3,(function(){Ce.sndMgr.playOneShot("Water_Splash_Big")}))}))})).tag(1247).start(),!0},r.showDeath=function(){},r.getHurtSndName=function(){return"Giant_Hurt_0"+qt(1,2)},o}(vn)).prototype,"attackFxPrefab",[xr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ar=t(Fr.prototype,"clockTimerUIPrefab",[_r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Rr=Fr));s._RF.pop(),s._RF.push({},"ba352QJP2hI/57jk4wRXEdj","Medusa",void 0);var Kr,Jr=k.WrapMode,Qr=u.ccclass,$r=u.property;zr=Qr("Medusa"),Lr=$r(x),kr=$r(R),Or=$r(R),Wr=$r(R),zr((Gr=t((Hr=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"heartFxNode",Gr,i(e)),n(e,"petrificationFxPrefab",Vr,i(e)),n(e,"magicLightFxPrefab",Xr,i(e)),n(e,"stoneBrokenFxPrefab",Zr,i(e)),e}e(o,t);var s=o.prototype;return s.init=function(e,n){t.prototype.init.call(this,e,n),this.oddsIndex=M.randomRangeInt(0,this.oddsList.length),this.oddsText.string="X"+Yt(this.oddsList)},s.playIdle=function(){var t=this.monsterAnims;if(Math.random()<.333)Xt(t[0],"idle01");else{var e=jt(["idle02","idle03"]);Xt(t[0],e,Jr.Normal,(function(){Xt(t[0],"idle01")})),"idle03"===e&&Xt(this.heartFxNode,"",Jr.Normal)}},s.showReward=function(t){var e=this;this.using=!1,this.canShowHurt=!1,this.colliders.forEach((function(t){return t.enabled=!1})),Ce.monsterMgr.removeFromEntitiesMap(this.id);var n=this.monsterAnims,i=this.node,o=Vt(Ce.cam3D,Ce.cam2D,i.worldPosition),r=N(this.petrificationFxPrefab);return r.setParent(Ce.node.effect2DLayer),r.setWorldPosition(o),Xt(r,"",Jr.Normal,(function(){r.destroy()})),T(r).delay(.5).call((function(){Ce.sndMgr.playOneShot("Medusa_01")})).to(.25,{position:v(0,60,0)}).call((function(){Ce.sndMgr.playOneShot("Medusa_02")})).start(),this.stopFloating(),Xt(n[0],"attack",Jr.Normal),ie(i,.7,(function(){return e.showPetrification()})),ie(i,2.7,(function(){e.reuse=!1,Ce.sndMgr.playOneShot("Water_Splash_Small"),Xt(e.commonAnim,"NoFallDead",null,(function(){i.destroy()}));var n=Ce.effectMgr,o=n.getWaterHeight(),r=Ce.uiCtrl.getPlayerCoinUIWpos3D(),s=v(i.worldPosition);s.y=o,s.z+=40,n.showGetCoins(s,r,t,(function(){Ce.gameCtrl.addPlayerCoins(t),Ce.uiCtrl.updatePlayerCoins()})),ie(i,.3,(function(){var t=v(i.worldPosition);t.y=o,Ce.effectMgr.playWaterSplashFx(t,2,!1)}))})),!0},s.showPetrification=function(){var t=this,e=this.node,n=Vt(Ce.cam3D,Ce.cam2D,e.worldPosition),i=Ce.monsterMgr.getEntitiesInRange(n,700,this.getOdds()),o=Ce.effectMgr.getWaterHeight(),s=Ce.uiCtrl.getPlayerCoinUIWpos3D(),a=this.stoneBrokenFxPrefab;ie(Ce.gameCtrl.timer,2,(function(){mr(Ce.cam3D.node,.8,25,4,.97)}));for(var l,u=function(){var e=l.value;if(!e.isUsing()||!e.node)return"continue";e.setUsing(!1),e.colliders.forEach((function(t){return t.enabled=!1})),Ce.monsterMgr.removeFromEntitiesMap(e.getID());var n=N(t.magicLightFxPrefab);n.setParent(Ce.node.effect3DLayer),n.setWorldPosition(e.node.worldPosition),te(n,(function(){e&&e.node&&n.setWorldPosition(e.node.worldPosition)})),Xt(n,"",Jr.Normal,(function(){n.destroy()})),e.monsterAnims.forEach((function(t){return t.stop()})),e.setGrayScale(1),e.setReuse(!1),T(e.node).delay(2).call((function(){var t=N(a);t.setParent(Ce.node.effect3DLayer),t.setWorldPosition(e.node.worldPosition);var n,i,o,r=t.position;n=t,i=r.y+30,o=n.position,n.setPosition(o.x,i,o.z),n.position,Xt(t,"",Jr.Normal,(function(){t.destroy()}))})).delay(.1).call((function(){e.monsterAnims[0].node.setPosition(0,-1e5,0);var t=v(e.node.worldPosition);t.y=o,t.z+=40,Ce.effectMgr.showGetCoins(t,s,0),t.z-=40,ie(e.node,.4,(function(){Ce.effectMgr.playWaterSplashFx(t,1,!1)})),T(e.node.children[0]).by(.8,de.props.position_0_n100_0).call((function(){return e.node.destroy()})).start()})).start()},c=r(i);!(l=c()).done;)u()},s.showDeath=function(){},o}(ir)).prototype,"heartFxNode",[Lr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vr=t(Hr.prototype,"petrificationFxPrefab",[kr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xr=t(Hr.prototype,"magicLightFxPrefab",[Or],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zr=t(Hr.prototype,"stoneBrokenFxPrefab",[Wr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ur=Hr));s._RF.pop(),s._RF.push({},"dd5ab+VncJNL62qvX8nNZBZ","NormalMonster",void 0);var ts,es=u.ccclass;u.property,es("NormalMonster")(Kr=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.init=function(e,n){t.prototype.init.call(this,e,n),this.oddsIndex=0,this.oddsText.string="X"+this.getOdds()},n}(ir));s._RF.pop(),s._RF.push({},"94712DiPYlOmbWcQipkuTnf","Timeline",void 0);var ns,is,os,rs,ss,as,ls,us,cs,hs,ps,ds,fs,gs=u.ccclass;u.property,gs("Timeline")(ts=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).id=1,e.myTween=null,e}e(n,t);var i=n.prototype;return i.onDestroy=function(){var t;null==(t=this.myTween)||t.stop(),this.myTween=null},i.start=function(){var t=this;te(this.node,(function(e){Ce.gameCtrl.isReadyToPlay()&&(t.startRunning(),e.stop())}))},i.startRunning=function(){var t=this;this.myTween=ne(this.node,153,(function(){t.playScript_GoldenGiant()}))},i.playScript_GoldenGiant=function(){var t=this,e=Ce.monsterMgr,n=this.node,i=new x("Script_1");i.layer=n.layer,i.setParent(n),ne(i,18.9,(function(){Kt(1,2,(function(n){ie(i,.1,(function(){return e.addEntity(Zo,t.id++,n)})),ie(i,2.1,(function(){return e.addEntity(qo,t.id++,n)})),ie(i,4.1,(function(){return e.addEntity(Zo,t.id++,n)})),ie(i,6.1,(function(){return e.addEntity(qo,t.id++,n)})),ie(i,8.2,(function(){return e.addEntity(jo,t.id++,n)})),ie(i,10.7,(function(){return e.addEntity(Yo,t.id++,n)})),ie(i,13.5,(function(){return e.addEntity(Ko,t.id++,n)})),ie(i,16.5,(function(){return e.addEntity(Jo,t.id++,n)}))}))})),ie(i,87,(function(){Ce.gameCtrl.getPlayerTurret().setLock(!0),Ce.effectMgr.showBossComing(200,(function(){Ce.gameCtrl.getPlayerTurret().setLock(!1)}))})),ie(i,90,(function(){A.stopAllByTarget(i),e.addEntity(Qo,t.id++,101),ne(i,17.9,(function(){Kt(3,4,(function(n){ie(i,.1,(function(){return e.addEntity(Zo,t.id++,n)})),ie(i,3.1,(function(){return e.addEntity(qo,t.id++,n)})),ie(i,6.1,(function(){return e.addEntity(Zo,t.id++,n)})),ie(i,9.1,(function(){return e.addEntity(qo,t.id++,n)})),ie(i,12.2,(function(){return e.addEntity(jo,t.id++,n)})),ie(i,15.5,(function(){return e.addEntity(Yo,t.id++,n)}))}))})),ne(i,20.4,(function(){Kt(5,6,(function(n){ie(i,.1,(function(){return e.addEntity(Yo,t.id++,n)})),ie(i,4,(function(){return e.addEntity(jo,t.id++,n)})),ie(i,7.6,(function(){return e.addEntity(qo,t.id++,n)})),ie(i,11.1,(function(){return e.addEntity(Zo,t.id++,n)})),ie(i,14.6,(function(){return e.addEntity(qo,t.id++,n)})),ie(i,18.1,(function(){return e.addEntity(Zo,t.id++,n)}))}))})),ie(i,54,(function(){A.stopAllByTarget(i),i.destroy()}))}))},n}(g));s._RF.pop(),s._RF.push({},"065aaClfoVGGaktqR57EFic","GlowFx",void 0);var ms,ys=u.ccclass,vs=u.property;ns=ys("GlowFx"),is=vs(c),os=vs(tt),rs=vs(tt),ns((ls=t((as=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"meshRenderer",ls,i(e)),n(e,"materialIdx",us,i(e)),n(e,"bleaching",cs,i(e)),n(e,"glowing",hs,i(e)),n(e,"moving",ps,i(e)),n(e,"offset",ds,i(e)),n(e,"tiling",fs,i(e)),e.lastBleaching=0,e.lastGlowing=0,e.material=null,e.uv=b(),e}e(o,t);var r=o.prototype;return r.start=function(){var t=this.meshRenderer;t&&(this.material=t.getMaterialInstance(this.materialIdx));var e=this.material;e&&(e.setProperty("offset",this.offset,0),e.setProperty("tiling",this.tiling,0),this.uv.set(this.offset))},r.update=function(t){var e=this.material;if(e){var n=this.bleaching,i=this.glowing,o=this.moving,r=this.uv;this.lastBleaching!==n&&(e.setProperty("bleaching",n,0),this.lastBleaching=n),this.lastGlowing!==i&&(e.setProperty("glowing",i,0),this.lastGlowing=i),0===o.x&&0===o.y||(r.x=(r.x+o.x*t)%1,r.y=(r.y+o.y*t)%1,e.setProperty("offset",r,0))}},o}(g)).prototype,"meshRenderer",[is],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),us=t(as.prototype,"materialIdx",[vs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),cs=t(as.prototype,"bleaching",[vs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),hs=t(as.prototype,"glowing",[vs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ps=t(as.prototype,"moving",[os],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return b(0,0)}}),ds=t(as.prototype,"offset",[rs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return b(0,0)}}),fs=t(as.prototype,"tiling",[vs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ss=as));s._RF.pop(),s._RF.push({},"ce586Jwu4dHL69MYH0RNiIy","SceneExtent",void 0);var bs=u.ccclass;u.property,bs("SceneExtent")(ms=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).oldScale=v(),e}e(n,t);var i=n.prototype;return i.onLoad=function(){this.oldScale.set(this.node.scale)},i.onEnable=function(){this.onResize(),Ce.node.stage.on(x.EventType.SIZE_CHANGED,this.onResize,this)},i.onDisable=function(){Ce.node.stage.off(x.EventType.SIZE_CHANGED,this.onResize,this)},i.onResize=function(){var t=et.getDesignResolutionSize(),e=oe(Ce.node.stage,-1,-1),n=this.oldScale,i=e.width/t.width;this.node.setScale(n.x*i,n.y,n.z)},n}(g));s._RF.pop(),s._RF.push({},"d802f8UQk1C6afEpPbXOJvq","LabelBitmapAtlas",void 0);var Ps,ws,Ss=function(){function t(t,e){this.texture=null,this.textureBleeding=!0,this.space=1,this.freeRects=[],this.labelRectCache=new Map,this.isFull=!1;var n=new Ms;n.initWithSize(t,e),this.texture=n,this.freeRects.push(nt(0,0,t,e))}var e=t.prototype;return e.insert=function(t){if(!this.isPackable(t))return null;var e=t.ttfSpriteFrame,n=e.texture,i=this.texture,o=this.space,r=2*o,s=n.width+r,a=n.height+r;if(i.width<s)return null;if(i.height<a)return null;var l=0,u=0,c=this.labelRectCache.get(t);if(c&&c.height>=a&&c.width>=s)l=c.x+o,u=c.y+o,this.drawImageAt(n.image,l,u);else{this.remove(t);var h=this.getBestRect(s,a);if(-1===h){if(this.isFull)return null;this.isFull=!0,this.repack();var p=this.insert(t);return this.isFull=!p,p}var d=this.freeRects[h];l=d.x+o,u=d.y+o,this.drawImageAt(n.image,l,u),this.freeRects.splice(h,1),this.splitIntoFreeRects(d,s,a),this.labelRectCache.set(t,nt(d.x,d.y,s,a))}var f=e.rect.clone();f.x+=l,f.y+=u;var g=new it;return g.texture=i,g.rect=f,g.packable=!1,g},e.remove=function(t){var e=this.labelRectCache.get(t);e&&(this.freeRects.push(e),this.labelRectCache.delete(t),this.isFull=!1)},e.repack=function(){var t=this.texture,e=t.width,n=t.height;this.freeRects.length=0,this.freeRects.push(nt(0,0,e,n));var i=Array.from(this.labelRectCache.keys()).filter((function(t){return t.enabledInHierarchy})).sort((function(t,e){var n=t.ttfSpriteFrame.rect;return e.ttfSpriteFrame.rect.height-n.height}));this.labelRectCache.clear();for(var o,s=r(i);!(o=s()).done;){o.value.node.emit("update-inner-sprite",!0)}},e.isPackable=function(t){return t.ttfSpriteFrame&&t.cacheMode===U.CacheMode.NONE&&""!==t.string},e.getBestRect=function(t,e){for(var n=-1,i=Number.MAX_VALUE,o=0,r=this.freeRects.length;o<r;++o){var s=this.freeRects[o];if(!(s.height<e||s.width<t)){var a=s.height-e;a<i&&(i=a,n=o)}}return n},e.splitIntoFreeRects=function(t,e,n){var i=nt(t.x,t.y+n,t.width,t.height-n),o=nt(t.x+e,t.y,t.width-e,n);this.freeRects.push(i),this.freeRects.push(o)},e.drawImageAt=function(t,e,n){var i=this.texture;if(this.textureBleeding){var o=t.width,r=t.height;(o<=8||r<=8)&&(i.drawTextureAt(t,e-1,n-1),i.drawTextureAt(t,e-1,n+1),i.drawTextureAt(t,e+1,n-1),i.drawTextureAt(t,e+1,n+1)),i.drawTextureAt(t,e-1,n),i.drawTextureAt(t,e+1,n),i.drawTextureAt(t,e,n-1),i.drawTextureAt(t,e,n+1)}i.drawTextureAt(t,e,n)},t}(),Ms=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.initWithSize=function(t,e,n){void 0===n&&(n=ot.PixelFormat.RGBA8888),this.reset({width:t,height:e,format:n})},i.drawTextureAt=function(t,e,n){var i=this.getGFXTexture();if(t&&i){var o=this._getGFXDevice();if(o){var r=new d.BufferTextureCopy;r.texOffset.x=e,r.texOffset.y=n,r.texExtent.width=t.width,r.texExtent.height=t.height,o.copyTexImagesToTexture([t.data],i,[r])}}},n}(ot);s._RF.pop(),s._RF.push({},"bff92KP9EJFQ6/76WiJo/eS","BitmapLabel",void 0);var Ts=[rt(1024,512),rt(1024,1024),rt(1024,2048),rt(2048,2048)],Bs=0,Cs=null,xs=Ts[0],_s=xs.width,Rs=xs.height;Cs=new Ss(_s,Rs);var Fs,Ns=u.ccclass;u.property,Ns("BitmapLabel")(((ws=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).enableBitmapChangedEvent=!1,e.innerString="",e}e(n,t);var i=n.prototype;return i.onLoad=function(){var e;null==(e=t.prototype.onLoad)||e.call(this),this.cacheMode=st.NONE},i.onEnable=function(){var e;null==(e=t.prototype.onEnable)||e.call(this);var n=this.getSuperString();n!==this.innerString&&(this.innerString=n,this.updateInnerSprite()),this.node.on("update-inner-sprite",this.updateInnerSprite,this)},i.onDisable=function(){var e;this.node.off("update-inner-sprite",this.updateInnerSprite,this),Cs.remove(this),this.clearInnerSprite(),this.setSuperString(this.innerString),this.innerString="",null==(e=t.prototype.onDisable)||e.call(this)},i.updateInnerSprite=function(t){var e=this;if(void 0===t&&(t=!1),this.clearInnerSprite(),""!==this.innerString){var n=function t(){var n=Cs.insert(e);if(n){var i=e.getInnerSprite();i.spriteFrame=n,e.enableBitmapChangedEvent&&e.node.emit("bitmap-changed",i),e.setSuperString("")}else{if(Bs<Ts.length-1){var o=Ts[Bs+1],r=o.width,s=o.height;Bs+=1,function(t,e){if(Cs){Cs.texture.destroy();var n=new Ms;n.initWithSize(t,e),Cs.texture=n,Cs.repack()}}(r,s),t()}}};t?n():O.once(at.EVENT_END_FRAME,n)}},i.getInnerSprite=function(){var t=n.innerSpriteName,e=this.node.getChildByName(t);return e?e.getComponent(lt):this.addInnerSprite()},i.addInnerSprite=function(){var t=new x(n.innerSpriteName),e=t.addComponent(P),i=t.addComponent(lt),o=this.getComponent(P);return e.setAnchorPoint(o.anchorPoint),t.layer=this.node.layer,t.setParent(this.node),t.setSiblingIndex(0),i},i.clearInnerSprite=function(){var t=this.getInnerSprite();t.spriteFrame&&(t.spriteFrame.destroy(),t.spriteFrame=null,this.enableBitmapChangedEvent&&this.node.emit("bitmap-changed",t))},i.getSuperProperty=function(t,e){return Object.getOwnPropertyDescriptor(t,e)},i.setSuperString=function(t){var e;null==(e=this.getSuperProperty(U.prototype,"string"))||e.set.call(this,t)},i.getSuperString=function(){var t=this.getSuperProperty(U.prototype,"string");return t?t.get.call(this):""},i.setSuperCacheMode=function(t){var e;null==(e=this.getSuperProperty(U.prototype,"cacheMode"))||e.set.call(this,t)},i.getSuperColor=function(){var t=this.getSuperProperty(ut.prototype,"color");return t?t.get.call(this):ct.WHITE},i.setSuperColor=function(t){var e;null==(e=this.getSuperProperty(ut.prototype,"color"))||e.set.call(this,t)},o(n,[{key:"color",get:function(){return this.getSuperColor()},set:function(t){this.setSuperColor(t),this.updateInnerSprite()}},{key:"string",get:function(){var t=this.getSuperString();return""!==t?t:this.innerString},set:function(t){var e=t;""!==e&&e===this.innerString||(this.setSuperString(e),e!==this.innerString&&this.enabledInHierarchy&&(this.innerString=e,this.updateInnerSprite()))}},{key:"cacheMode",get:function(){return st.NONE},set:function(t){this.setSuperCacheMode(st.NONE)}}]),n}(U)).innerSpriteName="__INNER_LABEL_SPRITE__",Ps=ws));s._RF.pop(),s._RF.push({},"25105/RSTZP2L02gEEuwI8M","CameraResize",void 0);var As,Ds,Is,Es=u.ccclass;u.property,Es("CameraResize")(Fs=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).camera=null,e.hypotenuse=-1,e}e(n,t),n.updateScene=function(){O.getScene().getComponentsInChildren(n).forEach((function(t){return t.onResize()}))};var i=n.prototype;return i.onLoad=function(){this.camera=this.getComponent(q)},i.onDestroy=function(){this.camera=null},i.onEnable=function(){this.onResize(),et.on("canvas-resize",this.onResize,this)},i.onDisable=function(){et.off("canvas-resize",this.onResize,this)},i.onResize=function(){this.camera.projection===q.ProjectionType.ORTHO?this.orthoResize():this.perspectiveResize()},i.orthoResize=function(){var t=this.camera,e=ht.windowSize,n=Dt.scale;t.orthoHeight=e.height*n/et.getScaleY()/2},i.perspectiveResize=function(){var t=this.camera;-1===this.hypotenuse&&(this.hypotenuse=Math.tan(t.fov/2*pt.RAD));var e=ht.windowSize,n=et.getDesignResolutionSize(),i=n.width/n.height,o=1;e.width/e.height<=i&&(o=e.width/ht.devicePixelRatio/(e.height/ht.devicePixelRatio*i));var r=Dt.scale,s=Math.atan(this.hypotenuse/o)*pt.DEG*2*r;t.fovAxis=dt.scene.CameraFOVAxis.VERTICAL,t.fov=s},n}(g));s._RF.pop(),s._RF.push({},"7ebc3OmBg5GbL32Y8ORTu42","LabelSpacingX",void 0);var zs,Ls=u.ccclass,ks=u.property,Os=u.executeInEditMode,Ws=u.requireComponent;Ls("LabelSpacingX")(As=Ws(U)(As=Os((Is=t((Ds=function(t){function r(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"_spacingX",Is,i(e)),e}e(r,t);var s=r.prototype;return s.onEnable=function(){this.resetSpacingX()},s.resetSpacingX=function(){var t=this.getComponent(U);t&&t.cacheMode===U.CacheMode.CHAR&&(t.spacingX=this._spacingX)},o(r,[{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX=t,this.resetSpacingX()}}]),r}(g)).prototype,"_spacingX",[ks],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),t(Ds.prototype,"spacingX",[ks],Object.getOwnPropertyDescriptor(Ds.prototype,"spacingX"),Ds.prototype),As=Ds))||As)||As);s._RF.pop(),s._RF.push({},"70fa928PtNCcZvsXNQKVFFh","SceneViewResize",void 0);var Us,Hs,Gs,Vs,Xs,Zs,qs,js,Ys,Ks,Js,Qs=u.ccclass,$s=(u.property,u.requireComponent),ta=Qs("SceneViewResize")(zs=$s(P)(zs=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.onEnable=function(){this.onResize(),et.on("canvas-resize",this.onResize,this)},i.onDisable=function(){et.off("canvas-resize",this.onResize,this)},i.onResize=function(){var t=ht.devicePixelRatio,e=ht.windowSize,n=et.getDesignResolutionSize(),i=rt(e.width/t,e.height/t),o=i.width/i.height,r=n.width/n.height,s=o>r,a=!1===s&&o!==r,l=Dt,u=l.maxLongSideRate,c=l.maxShortSideRate,h=rt(n);if(!0===s){var p=h.height*u,d=h.height*o;h.width=Math.floor(Math.min(d,p))}if(!0===a){var f=h.width*c,g=h.width/o;h.height=Math.floor(Math.min(g,f))}this.getComponent(P).setContentSize(h)},n}(g))||zs)||zs;s._RF.pop(),s._RF.push({},"34e9bj9PbpAB7jFZUXrqZCj","SceneViewBorder",void 0);var ea,na,ia,oa,ra,sa=u.ccclass,aa=u.property;Us=sa("SceneViewBorder"),Hs=aa(P),Gs=aa(P),Vs=aa(P),Xs=aa(P),Us((js=t((qs=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"left",js,i(e)),n(e,"right",Ys,i(e)),n(e,"top",Ks,i(e)),n(e,"bottom",Js,i(e)),e}e(o,t);var r=o.prototype;return r.onEnable=function(){this.onResize(),et.on("canvas-resize",this.onResize,this)},r.onDisable=function(){et.off("canvas-resize",this.onResize,this)},r.onResize=function(){var t=ht.devicePixelRatio,e=ht.windowSize,n=et.getDesignResolutionSize(),i=rt(e.width/t,e.height/t),o=i.width/i.height,r=n.width/n.height,s=o>r,a=!s&&!ft(o,r),l=O.getScene().getComponentInChildren(ta).node.getComponent(P).contentSize,u=Dt,c=u.maxLongSideRate,h=u.maxShortSideRate,p=Math.min(n.width,n.height)*c,d=Math.max(n.width,n.height)*h;if(!1===n.width>n.height){var f=[d,p];p=f[0],d=f[1]}if(this.closeAllBoarders(),!0===s){var g=n.height/i.height,m=i.width*g;if(m>p){var y=(m-p)/2+50;this.openLeftRightBoarders(l,y)}}if(!0===a){var v=n.width/i.width,b=i.height*v;if(b>d){var w=(b-d)/2+50;this.openTopBottomBoarders(l,w)}}},r.openLeftRightBoarders=function(t,e){var n=this.left,i=this.right;n.node.active=!0,i.node.active=!0,n.node.setPosition(-Math.floor(t.width/2),n.node.position.y),i.node.setPosition(Math.floor(t.width/2),i.node.position.y),n.setContentSize(e,t.height),i.setContentSize(e,t.height)},r.openTopBottomBoarders=function(t,e){var n=this.top,i=this.bottom;n.node.active=!0,i.node.active=!0,n.node.setPosition(n.node.position.x,Math.floor(t.height/2)),i.node.setPosition(i.node.position.x,-Math.floor(t.height/2)),n.setContentSize(t.width,e),i.setContentSize(t.width,e)},r.closeAllBoarders=function(){this.left.node.active=!1,this.right.node.active=!1,this.top.node.active=!1,this.bottom.node.active=!1},o}(g)).prototype,"left",[Hs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ys=t(qs.prototype,"right",[Gs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ks=t(qs.prototype,"top",[Vs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Js=t(qs.prototype,"bottom",[Xs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zs=qs));s._RF.pop(),s._RF.push({},"6169ee5JrVJjZ/zn6vYo383","ScreenCursor",void 0);var la,ua=u.ccclass,ca=u.property;ea=ua("ScreenCursor"),na=ca({type:x,tooltip:"鼠標圖示節點"}),ea((ra=t((oa=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"cursorNode",ra,i(e)),e.loc=b(),e.isShow=!1,e}e(o,t);var r=o.prototype;return r.onEnable=function(){var t=a.isBrowser&&!a.isMobile;if(this.node.active=t,this.isShow=t,t){var e=et.getDesignResolutionSize(),n=2*Math.max(e.width,e.height);this.getComponent(P).setContentSize(n,n),this.node.on(x.EventType.MOUSE_MOVE,this.updatePositionByMouse,this),document.body.style.cursor="none"}},r.onDisable=function(){this.isShow&&this.node.off(x.EventType.MOUSE_MOVE,this.updatePositionByMouse,this)},r.updatePositionByMouse=function(t){var e=t.getUILocation(this.loc);this.cursorNode.setWorldPosition(e.x,e.y,0)},o}(g)).prototype,"cursorNode",[na],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ia=oa));s._RF.pop(),s._RF.push({},"eddb44fuedAkaRRnjMbkOmr","SpeedUpTest",void 0);var ha,pa,da,fa,ga,ma=u.ccclass;u.property,ma("SpeedUpTest")(la=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).moreTimes=0,e.isSpeedingUp=!1,e}e(n,t);var i=n.prototype;return i.onLoad=function(){It.isDevTest&&G.on(V.EventType.KEY_DOWN,this.onKeyDown,this)},i.onDestroy=function(){It.isDevTest&&G.off(V.EventType.KEY_DOWN,this.onKeyDown,this)},i.lateUpdate=function(t){if(!(this.moreTimes<=0||this.isSpeedingUp)){this.isSpeedingUp=!0;for(var e=0,n=this.moreTimes;e<n;++e)H.step();this.isSpeedingUp=!1}},i.onKeyDown=function(t){if(t.keyCode===X.F8){this.moreTimes=this.moreTimes<=0?7:0}},n}(g));s._RF.pop(),s._RF.push({},"23681h4cBRJwZT9Z0yN+YOx","StaticMeshBatcher",void 0);var ya,va,ba,Pa,wa,Sa,Ma,Ta=u.ccclass,Ba=u.property;ha=Ta("StaticMeshBatcher"),pa=Ba({tooltip:"當合併完成時, 是否銷毀自身節點"}),ha((ga=t((fa=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"destroySelf",ga,i(e)),e}return e(o,t),o.prototype.start=function(){var t=this.node,e=new x(t.name+"_Batched");if(e.layer=t.layer,e.setParent(t.parent),e.setSiblingIndex(t.getSiblingIndex()),e.setRTS(t.rotation,t.position,t.scale),!gt.batchStaticModel(t,e))return mt("Meshes are batching failed."),void e.destroy();this.destroySelf&&t.destroy()},o}(g)).prototype,"destroySelf",[pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),da=fa));s._RF.pop(),s._RF.push({},"b89d6Z2V05FW7vFvgfYl54F","UIShrink",void 0);var Ca=u.ccclass,xa=u.property,_a=u.disallowMultiple,Ra=u.executeInEditMode;ya=Ca("UIShrink"),va=_a(!0),ba=Ra(!0),Pa=xa({tooltip:"最大內容尺寸 (若寬或高為負值, 則表示不在該方向做尺寸限制)"}),ya(wa=va(wa=ba((Ma=t((Sa=function(t){function r(){for(var e,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,n(e,"_maxUISize",Ma,i(e)),e}e(r,t);var s=r.prototype;return s.onEnable=function(){this.shrink(),this.node.on(x.EventType.SIZE_CHANGED,this.shrink,this)},s.onDisable=function(){this.node.off(x.EventType.SIZE_CHANGED,this.shrink,this)},s.shrink=function(){var t=Math.max,e=Math.min,n=this.getComponent(P),i=n.width,o=n.height,r=this._maxUISize.width/t(1,i),s=this._maxUISize.height/t(1,o);if(!(r<0&&s<0)){var a=yt(e(r<0?s:r,s<0?r:s));this.node.setScale(a,a)}},o(r,[{key:"maxUISize",get:function(){return this._maxUISize},set:function(t){this._maxUISize=t,this.shrink()}}]),r}(g)).prototype,"_maxUISize",[xa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return rt(200,-1)}}),t(Sa.prototype,"maxUISize",[Pa],Object.getOwnPropertyDescriptor(Sa.prototype,"maxUISize"),Sa.prototype),wa=Sa))||wa)||wa);s._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/game', 'chunks:///game.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});